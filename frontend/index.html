<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TalentFlow AI - Intelligent HR Platform</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Instrument+Serif:ital@0;1&display=swap"
    rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-primary: #f8fafc;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f1f5f9;
      --bg-card: #ffffff;
      --border-color: #e2e8f0;
      --border-hover: #cbd5e1;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --accent-primary: #0d9488;
      --accent-secondary: #0f766e;
      --accent-glow: rgba(13, 148, 136, 0.12);
      --accent-blue: #3b82f6;
      --accent-purple: #8b5cf6;
      --accent-orange: #f97316;
      --danger: #ef4444;
      --success: #22c55e;
      --warning: #eab308;
      --gradient-mesh: radial-gradient(ellipse at 20% 0%, rgba(13, 148, 136, 0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 100%, rgba(59, 130, 246, 0.04) 0%, transparent 50%);
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .serif {
      font-family: 'Instrument Serif', Georgia, serif;
    }

    #root {
      min-height: 100vh;
    }

    ::selection {
      background: var(--accent-primary);
      color: var(--bg-primary);
    }

    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--border-hover);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    @keyframes ripple {
      0% {
        transform: scale(1);
        opacity: 0.4;
      }

      100% {
        transform: scale(2.5);
        opacity: 0;
      }
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    @keyframes waveform {

      0%,
      100% {
        height: 8px;
      }

      50% {
        height: 24px;
      }
    }

    .animate-in {
      animation: fadeInUp 0.6s ease-out forwards;
    }

    .delay-1 {
      animation-delay: 0.1s;
    }

    .delay-2 {
      animation-delay: 0.2s;
    }

    .delay-3 {
      animation-delay: 0.3s;
    }

    .delay-4 {
      animation-delay: 0.4s;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;

    // ==================== ICONS ====================
    const Icons = {
      Briefcase: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
          <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
        </svg>
      ),
      FileText: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
          <polyline points="14,2 14,8 20,8" />
          <line x1="16" y1="13" x2="8" y2="13" />
          <line x1="16" y1="17" x2="8" y2="17" />
          <polyline points="10,9 9,9 8,9" />
        </svg>
      ),
      Phone: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
        </svg>
      ),
      Users: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
          <circle cx="9" cy="7" r="4" />
          <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
          <path d="M16 3.13a4 4 0 0 1 0 7.75" />
        </svg>
      ),
      Upload: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="17,8 12,3 7,8" />
          <line x1="12" y1="3" x2="12" y2="15" />
        </svg>
      ),
      Mic: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
          <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
          <line x1="12" y1="19" x2="12" y2="23" />
          <line x1="8" y1="23" x2="16" y2="23" />
        </svg>
      ),
      MicOff: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <line x1="1" y1="1" x2="23" y2="23" />
          <path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6" />
          <path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23" />
          <line x1="12" y1="19" x2="12" y2="23" />
          <line x1="8" y1="23" x2="16" y2="23" />
        </svg>
      ),
      PhoneCall: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
        </svg>
      ),
      PhoneOff: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91" />
          <line x1="23" y1="1" x2="1" y2="23" />
        </svg>
      ),
      Search: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="11" cy="11" r="8" />
          <line x1="21" y1="21" x2="16.65" y2="16.65" />
        </svg>
      ),
      Check: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polyline points="20,6 9,17 4,12" />
        </svg>
      ),
      X: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      ),
      ChevronRight: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polyline points="9,18 15,12 9,6" />
        </svg>
      ),
      Sparkles: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M12 3l1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3z" />
        </svg>
      ),
      BarChart: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <line x1="12" y1="20" x2="12" y2="10" />
          <line x1="18" y1="20" x2="18" y2="4" />
          <line x1="6" y1="20" x2="6" y2="16" />
        </svg>
      ),
      Settings: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="12" r="3" />
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
        </svg>
      ),
      Globe: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="12" r="10" />
          <line x1="2" y1="12" x2="22" y2="12" />
          <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z" />
        </svg>
      ),
      Award: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="8" r="7" />
          <polyline points="8.21,13.89 7,23 12,20 17,23 15.79,13.88" />
        </svg>
      ),
      Zap: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2" />
        </svg>
      ),
      Play: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polygon points="5,3 19,12 5,21 5,3" />
        </svg>
      ),
      Pause: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <rect x="6" y="4" width="4" height="16" />
          <rect x="14" y="4" width="4" height="16" />
        </svg>
      ),
      Copy: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
        </svg>
      ),
      Download: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="7,10 12,15 17,10" />
          <line x1="12" y1="15" x2="12" y2="3" />
        </svg>
      ),
      Linkedin: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
          <rect x="2" y="9" width="4" height="12" />
          <circle cx="4" cy="4" r="2" />
        </svg>
      ),
      Mail: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
          <polyline points="22,6 12,13 2,6" />
        </svg>
      ),
      Trash: () => (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polyline points="3,6 5,6 21,6" />
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
          <line x1="10" y1="11" x2="10" y2="17" />
          <line x1="14" y1="11" x2="14" y2="17" />
        </svg>
      )
    };

    // ==================== STYLES ====================
    const styles = {
      container: {
        minHeight: '100vh',
        background: 'var(--bg-primary)',
        backgroundImage: 'var(--gradient-mesh)',
        backgroundAttachment: 'fixed',
      },
      header: {
        position: 'fixed',
        top: 0,
        left: 0,
        right: 0,
        padding: '16px 32px',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'space-between',
        background: 'rgba(248, 250, 252, 0.9)',
        backdropFilter: 'blur(20px)',
        borderBottom: '1px solid var(--border-color)',
        zIndex: 1000,
      },
      logo: {
        display: 'flex',
        alignItems: 'center',
        gap: '12px',
        fontSize: '20px',
        fontWeight: '600',
        color: 'var(--text-primary)',
      },
      logoIcon: {
        width: '36px',
        height: '36px',
        borderRadius: '10px',
        background: 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        color: '#ffffff',
      },
      nav: {
        display: 'flex',
        gap: '8px',
      },
      navButton: (active) => ({
        padding: '10px 20px',
        fontSize: '14px',
        fontWeight: '500',
        color: active ? 'var(--text-primary)' : 'var(--text-secondary)',
        background: active ? 'var(--bg-tertiary)' : 'transparent',
        border: 'none',
        borderRadius: '8px',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
      }),
      main: {
        paddingTop: '100px',
        paddingBottom: '60px',
        maxWidth: '1400px',
        margin: '0 auto',
        padding: '100px 32px 60px',
      },
      pageHeader: {
        marginBottom: '48px',
        opacity: 0,
        animation: 'fadeInUp 0.6s ease-out forwards',
      },
      pageTitle: {
        fontSize: '48px',
        fontWeight: '400',
        marginBottom: '12px',
        lineHeight: '1.1',
      },
      pageSubtitle: {
        fontSize: '18px',
        color: 'var(--text-secondary)',
        maxWidth: '600px',
      },
      grid: {
        display: 'grid',
        gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',
        gap: '24px',
      },
      card: {
        background: 'var(--bg-card)',
        borderRadius: '16px',
        border: '1px solid var(--border-color)',
        padding: '32px',
        transition: 'all 0.3s ease',
      },
      cardHeader: {
        display: 'flex',
        alignItems: 'center',
        gap: '16px',
        marginBottom: '24px',
      },
      cardIcon: (color) => ({
        width: '48px',
        height: '48px',
        borderRadius: '12px',
        background: `linear-gradient(135deg, ${color}20 0%, ${color}10 100%)`,
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        color: color,
      }),
      cardTitle: {
        fontSize: '20px',
        fontWeight: '600',
        marginBottom: '4px',
      },
      cardDescription: {
        fontSize: '14px',
        color: 'var(--text-secondary)',
      },
      formGroup: {
        marginBottom: '20px',
      },
      label: {
        display: 'block',
        fontSize: '13px',
        fontWeight: '500',
        color: 'var(--text-secondary)',
        marginBottom: '8px',
        textTransform: 'uppercase',
        letterSpacing: '0.5px',
      },
      input: {
        width: '100%',
        padding: '14px 16px',
        fontSize: '15px',
        color: 'var(--text-primary)',
        background: 'var(--bg-secondary)',
        border: '1px solid var(--border-color)',
        borderRadius: '10px',
        outline: 'none',
        transition: 'all 0.2s ease',
        fontFamily: 'inherit',
      },
      textarea: {
        width: '100%',
        padding: '14px 16px',
        fontSize: '15px',
        color: 'var(--text-primary)',
        background: 'var(--bg-secondary)',
        border: '1px solid var(--border-color)',
        borderRadius: '10px',
        outline: 'none',
        transition: 'all 0.2s ease',
        resize: 'vertical',
        minHeight: '120px',
        fontFamily: 'inherit',
      },
      select: {
        width: '100%',
        padding: '14px 16px',
        fontSize: '15px',
        color: 'var(--text-primary)',
        background: 'var(--bg-secondary)',
        border: '1px solid var(--border-color)',
        borderRadius: '10px',
        outline: 'none',
        cursor: 'pointer',
        appearance: 'none',
        backgroundImage: `url("data:image/svg+xml,%3Csvg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M3 4.5L6 7.5L9 4.5' stroke='%23a1a1a6' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E")`,
        backgroundRepeat: 'no-repeat',
        backgroundPosition: 'right 16px center',
      },
      button: (variant = 'primary') => ({
        padding: '14px 28px',
        fontSize: '15px',
        fontWeight: '600',
        color: variant === 'primary' ? '#ffffff' : 'var(--text-primary)',
        background: variant === 'primary'
          ? 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%)'
          : 'var(--bg-tertiary)',
        border: variant === 'primary' ? 'none' : '1px solid var(--border-color)',
        borderRadius: '10px',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
        display: 'inline-flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '8px',
        fontFamily: 'inherit',
      }),
      dropzone: (isDragActive) => ({
        padding: '40px',
        border: `2px dashed ${isDragActive ? 'var(--accent-primary)' : 'var(--border-color)'}`,
        borderRadius: '12px',
        background: isDragActive ? 'var(--accent-glow)' : 'var(--bg-secondary)',
        textAlign: 'center',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
      }),
      resultCard: {
        background: 'var(--bg-secondary)',
        borderRadius: '12px',
        padding: '24px',
        marginTop: '24px',
        border: '1px solid var(--border-color)',
      },
      scoreCircle: (score) => {
        const color = score >= 70 ? 'var(--success)' : score >= 40 ? 'var(--warning)' : 'var(--danger)';
        return {
          width: '120px',
          height: '120px',
          borderRadius: '50%',
          background: `conic-gradient(${color} ${score * 3.6}deg, var(--bg-tertiary) 0deg)`,
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          margin: '0 auto 20px',
          position: 'relative',
        };
      },
      scoreInner: {
        width: '100px',
        height: '100px',
        borderRadius: '50%',
        background: 'var(--bg-secondary)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        flexDirection: 'column',
      },
      voiceAgent: {
        textAlign: 'center',
        padding: '40px',
      },
      voiceCircle: (isActive) => ({
        width: '180px',
        height: '180px',
        borderRadius: '50%',
        background: isActive
          ? 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)'
          : 'var(--bg-tertiary)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        margin: '0 auto 32px',
        cursor: 'pointer',
        transition: 'all 0.3s ease',
        position: 'relative',
        boxShadow: isActive ? '0 0 60px var(--accent-glow)' : 'none',
      }),
      waveformContainer: {
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '4px',
        height: '40px',
      },
      tag: (color) => ({
        padding: '4px 10px',
        background: `${color}15`,
        color: color,
        borderRadius: '6px',
        fontSize: '12px',
        fontWeight: '600',
        display: 'inline-block',
      }),
      waveformBar: (index, isActive) => ({
        width: '4px',
        height: isActive ? '24px' : '8px',
        background: isActive ? 'var(--accent-primary)' : 'var(--text-muted)',
        borderRadius: '2px',
        transition: 'height 0.1s ease',
        animation: isActive ? `waveform 0.5s ease-in-out ${index * 0.1}s infinite` : 'none',
      }),
      transcript: {
        maxHeight: '300px',
        overflowY: 'auto',
        padding: '20px',
        background: 'var(--bg-secondary)',
        borderRadius: '12px',
        marginTop: '24px',
        textAlign: 'left',
      },
      transcriptMessage: (role) => ({
        marginBottom: '16px',
        padding: '12px 16px',
        borderRadius: '12px',
        background: role === 'assistant' ? 'var(--bg-tertiary)' : 'var(--accent-glow)',
        borderLeft: `3px solid ${role === 'assistant' ? 'var(--accent-blue)' : 'var(--accent-primary)'}`,
      }),
      tag: (color) => ({
        display: 'inline-block',
        padding: '4px 12px',
        fontSize: '12px',
        fontWeight: '600',
        color: color,
        background: `${color}15`,
        borderRadius: '20px',
        marginRight: '8px',
        marginBottom: '8px',
      }),
      tabs: {
        display: 'flex',
        gap: '4px',
        marginBottom: '24px',
        background: 'var(--bg-secondary)',
        padding: '4px',
        borderRadius: '10px',
        width: 'fit-content',
      },
      tab: (active) => ({
        padding: '10px 20px',
        fontSize: '14px',
        fontWeight: '500',
        color: active ? 'var(--text-primary)' : 'var(--text-secondary)',
        background: active ? 'var(--bg-tertiary)' : 'transparent',
        border: 'none',
        borderRadius: '8px',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
      }),
      statusBadge: (status) => {
        const colors = {
          pending: 'var(--warning)',
          completed: 'var(--success)',
          failed: 'var(--danger)',
          active: 'var(--accent-primary)',
        };
        return {
          display: 'inline-flex',
          alignItems: 'center',
          gap: '6px',
          padding: '6px 12px',
          fontSize: '12px',
          fontWeight: '600',
          color: colors[status] || 'var(--text-secondary)',
          background: `${colors[status] || 'var(--text-secondary)'}15`,
          borderRadius: '20px',
        };
      },
      candidateCard: {
        display: 'flex',
        alignItems: 'center',
        gap: '16px',
        padding: '16px',
        background: 'var(--bg-secondary)',
        borderRadius: '12px',
        marginBottom: '12px',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
        border: '1px solid transparent',
      },
      avatar: {
        width: '48px',
        height: '48px',
        borderRadius: '12px',
        background: 'linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        color: 'white',
        fontWeight: '600',
        fontSize: '18px',
      },
      progressBar: {
        width: '100%',
        height: '6px',
        background: 'var(--bg-tertiary)',
        borderRadius: '3px',
        overflow: 'hidden',
      },
      progressFill: (percent, color = 'var(--accent-primary)') => ({
        width: `${percent}%`,
        height: '100%',
        background: color,
        borderRadius: '3px',
        transition: 'width 0.5s ease',
      }),
      configSection: {
        background: 'var(--bg-secondary)',
        borderRadius: '12px',
        padding: '20px',
        marginBottom: '20px',
      },
      configTitle: {
        fontSize: '14px',
        fontWeight: '600',
        color: 'var(--text-primary)',
        marginBottom: '16px',
        display: 'flex',
        alignItems: 'center',
        gap: '8px',
      },
      codeBlock: {
        background: 'var(--bg-primary)',
        padding: '16px',
        borderRadius: '8px',
        fontFamily: 'Monaco, Consolas, monospace',
        fontSize: '13px',
        color: 'var(--accent-primary)',
        overflow: 'auto',
        marginTop: '12px',
      }
    };

    // ==================== API CONFIG ====================
    const API_CONFIG = {
      BASE_URL: 'http://localhost:8000',  // Update this to your API URL
      OPENAI_REALTIME_URL: 'wss://api.openai.com/v1/realtime',
    };

    // ==================== COMPONENTS ====================

    // Tab Component
    function Tabs({ tabs, activeTab, onChange }) {
      return (
        <div style={styles.tabs}>
          {tabs.map((tab) => (
            <button
              key={tab.id}
              style={styles.tab(activeTab === tab.id)}
              onClick={() => onChange(tab.id)}
              onMouseEnter={(e) => {
                if (activeTab !== tab.id) {
                  e.target.style.color = 'var(--text-primary)';
                }
              }}
              onMouseLeave={(e) => {
                if (activeTab !== tab.id) {
                  e.target.style.color = 'var(--text-secondary)';
                }
              }}
            >
              {tab.label}
            </button>
          ))}
        </div>
      );
    }

    // Loading Spinner
    function Spinner({ size = 20 }) {
      return (
        <div style={{
          width: size,
          height: size,
          border: '2px solid var(--bg-tertiary)',
          borderTopColor: 'var(--accent-primary)',
          borderRadius: '50%',
          animation: 'spin 0.8s linear infinite',
        }}>
          <style>{`@keyframes spin { to { transform: rotate(360deg); } }`}</style>
        </div>
      );
    }

    // Waveform Visualizer
    function Waveform({ isActive, bars = 12 }) {
      return (
        <div style={styles.waveformContainer}>
          {Array.from({ length: bars }).map((_, i) => (
            <div key={i} style={styles.waveformBar(i, isActive)} />
          ))}
        </div>
      );
    }

    // Score Circle
    function ScoreCircle({ score }) {
      const color = score >= 70 ? 'var(--success)' : score >= 40 ? 'var(--warning)' : 'var(--danger)';
      return (
        <div style={styles.scoreCircle(score)}>
          <div style={styles.scoreInner}>
            <span style={{ fontSize: '32px', fontWeight: '700', color }}>{score.toFixed(0)}</span>
            <span style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>/ 100</span>
          </div>
        </div>
      );
    }

    // ==================== PAGES ====================

    // Dashboard Page
    // Dashboard Page
    function DashboardPage({ onNavigate }) {
      const [stats, setStats] = useState([]);
      const [recentActivity, setRecentActivity] = useState([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        const fetchData = async () => {
          try {
            // Fetch stats
            const statsRes = await fetch(`${API_CONFIG.BASE_URL}/dashboard/stats/`);
            const statsData = await statsRes.json();

            // Fetch candidates for recent activity
            const candsRes = await fetch(`${API_CONFIG.BASE_URL}/candidates/`);
            const candsData = await candsRes.json();
            const apps = candsData.candidates || [];

            setStats([
              { label: 'Total Candidates', value: statsData.total, change: '+12%', icon: <Icons.Users /> },
              { label: 'Shortlisted', value: statsData.shortlisted, change: '+5%', icon: <Icons.Award /> },
              { label: 'Avg Score', value: `${statsData.avg_score}%`, change: '+2%', icon: <Icons.BarChart /> },
              { label: 'Pending Review', value: statsData.pending, change: '-3%', icon: <Icons.Briefcase /> },
            ]);

            // Map applications to recent activity
            const recent = apps.slice(0, 5).map(app => ({
              type: 'score',
              title: 'Resume Scored',
              candidate: app.candidate_name,
              time: new Date(app.created_at).toLocaleDateString(),
              score: app.score
            }));
            setRecentActivity(recent);
            setLoading(false);
          } catch (e) {
            console.error("Dashboard error", e);
            setLoading(false);
          }
        };
        fetchData();
      }, []);

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading dashboard...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Welcome back</span>
            </h1>
            <p style={styles.pageSubtitle}>
              Your AI-powered recruitment dashboard. Here's what's happening.
            </p>
          </div>

          <div style={{ ...styles.grid, gridTemplateColumns: 'repeat(4, 1fr)', marginBottom: '32px' }}>
            {stats.map((stat, i) => (
              <div
                key={stat.label}
                style={{ ...styles.card, opacity: 0 }}
                className={`animate-in delay-${i + 1}`}
              >
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '16px' }}>
                  <div style={{ color: 'var(--text-muted)' }}>{stat.icon}</div>
                  <span style={{
                    fontSize: '12px',
                    fontWeight: '600',
                    color: 'var(--success)',
                    background: 'rgba(34, 197, 94, 0.1)',
                    padding: '4px 8px',
                    borderRadius: '4px'
                  }}>{stat.change}</span>
                </div>
                <div style={{ fontSize: '36px', fontWeight: '700', marginBottom: '4px' }}>{stat.value}</div>
                <div style={{ fontSize: '14px', color: 'var(--text-secondary)' }}>{stat.label}</div>
              </div>
            ))}
          </div>

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-2">
              <h3 style={{ fontSize: '18px', fontWeight: '600', marginBottom: '20px' }}>Recent Activity</h3>
              {recentActivity.length > 0 ? recentActivity.map((activity, i) => (
                <div
                  key={i}
                  style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '16px',
                    padding: '12px 0',
                    borderBottom: i < recentActivity.length - 1 ? '1px solid var(--border-color)' : 'none'
                  }}
                >
                  <div style={{
                    width: '40px',
                    height: '40px',
                    borderRadius: '10px',
                    background: 'rgba(0, 212, 170, 0.1)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    color: 'var(--accent-primary)',
                  }}>
                    <Icons.FileText />
                  </div>
                  <div style={{ flex: 1 }}>
                    <div style={{ fontWeight: '500', marginBottom: '2px' }}>{activity.title}</div>
                    <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>
                      {activity.candidate}
                    </div>
                  </div>
                  {activity.score && (
                    <div style={{
                      padding: '4px 12px',
                      borderRadius: '20px',
                      background: activity.score >= 70 ? 'rgba(34, 197, 94, 0.1)' : 'rgba(234, 179, 8, 0.1)',
                      color: activity.score >= 70 ? 'var(--success)' : 'var(--warning)',
                      fontWeight: '600',
                      fontSize: '13px'
                    }}>
                      {activity.score}%
                    </div>
                  )}
                  <div style={{ fontSize: '12px', color: 'var(--text-muted)' }}>{activity.time}</div>
                </div>
              )) : (
                <div style={{ color: 'var(--text-muted)', padding: '20px' }}>No recent activity</div>
              )}
            </div>

            <div style={styles.card} className="animate-in delay-3">
              <h3 style={{ fontSize: '18px', fontWeight: '600', marginBottom: '20px' }}>Quick Actions</h3>
              <div style={{ display: 'grid', gap: '12px' }}>
                {[
                  { icon: <Icons.FileText />, label: 'Score Resume', desc: 'Analyze candidate fit', color: 'var(--accent-primary)', target: 'resume' },
                  { icon: <Icons.Briefcase />, label: 'Create JD', desc: 'Generate job description', color: 'var(--accent-blue)', target: 'jd' },
                ].map((action) => (
                  <div
                    key={action.label}
                    style={{
                      display: 'flex',
                      alignItems: 'center',
                      gap: '16px',
                      padding: '16px',
                      background: 'var(--bg-secondary)',
                      borderRadius: '12px',
                      cursor: 'pointer',
                      transition: 'all 0.2s ease',
                      border: '1px solid transparent',
                    }}
                    onClick={() => onNavigate && onNavigate(action.target)}
                    onMouseEnter={(e) => {
                      e.currentTarget.style.borderColor = action.color;
                      e.currentTarget.style.background = `${action.color}08`;
                    }}
                    onMouseLeave={(e) => {
                      e.currentTarget.style.borderColor = 'transparent';
                      e.currentTarget.style.background = 'var(--bg-secondary)';
                    }}
                  >
                    <div style={{ color: action.color }}>{action.icon}</div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '500' }}>{action.label}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{action.desc}</div>
                    </div>
                    <Icons.ChevronRight />
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }


    // Resume Scoring Page
    // Resume Scoring Page


    function ResumeScorePage() {
      const [jobDescription, setJobDescription] = useState('');
      const [resumeFiles, setResumeFiles] = useState([]); // Changed to array
      const [candidateName, setCandidateName] = useState('');
      const [isDragActive, setIsDragActive] = useState(false);
      const [loading, setLoading] = useState(false);
      const [results, setResults] = useState(null); // Changed to hold multiple results or single result object
      const [error, setError] = useState(null);
      const fileInputRef = useRef(null);

      const handleDrop = useCallback((e) => {
        e.preventDefault();
        setIsDragActive(false);
        const files = Array.from(e.dataTransfer.files).filter(file => file.name.endsWith('.pdf') || file.name.endsWith('.docx'));
        if (files.length > 0) {
          setResumeFiles(prev => [...prev, ...files].slice(0, 5)); // Limit to 5
        }
      }, []);

      const handleFileSelect = (e) => {
        const files = Array.from(e.target.files).filter(file => file.name.endsWith('.pdf') || file.name.endsWith('.docx'));
        if (files.length > 0) {
          setResumeFiles(prev => [...prev, ...files].slice(0, 5));
        }
      };

      const removeFile = (index) => {
        setResumeFiles(prev => prev.filter((_, i) => i !== index));
      };

      const handleSubmit = async () => {
        if (!jobDescription || resumeFiles.length === 0) return;

        setLoading(true);
        setError(null);
        setResults(null);

        try {
          const formData = new FormData();
          formData.append('job_description', jobDescription);

          let endpoint = '';

          if (resumeFiles.length === 1) {
            // Single file mode
            formData.append('resume_file', resumeFiles[0]);
            if (candidateName) formData.append('candidate_name', candidateName);
            endpoint = `${API_CONFIG.BASE_URL}/score_resume/`;
          } else {
            // Batch mode
            resumeFiles.forEach(file => {
              formData.append('resume_files', file);
            });
            endpoint = `${API_CONFIG.BASE_URL}/score_resumes_batch/`;
          }

          const response = await fetch(endpoint, {
            method: 'POST',
            body: formData,
          });

          if (!response.ok) {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.detail || 'Failed to analyze resume(s)');
          }

          const data = await response.json();

          // Normalize results
          if (resumeFiles.length === 1) {
            setResults([data]); // Wrap single result in array
          } else {
            setResults(data.results);
          }

        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Batch Resume</span> Scoring
            </h1>
            <p style={styles.pageSubtitle}>
              Upload up to 5 resumes to compare candidates against your job description instantly.
            </p>
          </div>

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-primary)')}>
                  <Icons.FileText />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Application Details</h3>
                  <p style={styles.cardDescription}>Enter candidate and job info</p>
                </div>
              </div>

              {/* Only show Candidate Name if 1 file is selected */}
              {resumeFiles.length <= 1 && (
                <div style={styles.formGroup}>
                  <label style={styles.label}>Candidate Name (Optional)</label>
                  <div style={{ position: 'relative' }}>
                    <Icons.Users style={{ position: 'absolute', left: '12px', top: '50%', transform: 'translateY(-50%)', color: 'var(--text-secondary)', width: '16px' }} />
                    <input
                      style={{ ...styles.input, paddingLeft: '36px' }}
                      placeholder="e.g. John Doe"
                      value={candidateName}
                      onChange={(e) => setCandidateName(e.target.value)}
                    />
                  </div>
                </div>
              )}

              <div style={styles.formGroup}>
                <label style={styles.label}>Job Description</label>
                <textarea
                  style={{ ...styles.textarea, height: '150px' }}
                  placeholder="Paste the job requirements here..."
                  value={jobDescription}
                  onChange={(e) => setJobDescription(e.target.value)}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Resume Upload (Max 5)</label>
                <div
                  style={styles.dropzone(isDragActive)}
                  onDragOver={(e) => { e.preventDefault(); setIsDragActive(true); }}
                  onDragLeave={() => setIsDragActive(false)}
                  onDrop={handleDrop}
                  onClick={() => fileInputRef.current?.click()}
                >
                  <input
                    type="file"
                    ref={fileInputRef}
                    style={{ display: 'none' }}
                    onChange={handleFileSelect}
                    accept=".pdf,.docx"
                    multiple
                  />
                  <div style={{ marginBottom: '12px', color: 'var(--accent-primary)' }}>
                    <Icons.Upload />
                  </div>
                  <div style={{ fontWeight: '500', marginBottom: '4px' }}>
                    {resumeFiles.length > 0
                      ? `${resumeFiles.length} file(s) selected`
                      : 'Click to upload or drag & drop'}
                  </div>
                  <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>PDF or DOCX (Max 5MB)</div>
                </div>

                {resumeFiles.length > 0 && (
                  <div style={{ marginTop: '12px', display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                    {resumeFiles.map((file, i) => (
                      <div key={i} style={{
                        background: 'var(--bg-tertiary)',
                        padding: '6px 12px',
                        borderRadius: '8px',
                        fontSize: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        <span>{file.name}</span>
                        <button
                          onClick={() => removeFile(i)}
                          style={{ border: 'none', background: 'none', cursor: 'pointer', color: 'var(--text-secondary)' }}
                        >
                          <Icons.X />
                        </button>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {error && (
                <div style={{ padding: '12px', background: 'rgba(239, 68, 68, 0.1)', color: 'var(--danger)', borderRadius: '8px', marginBottom: '20px', fontSize: '14px' }}>
                  {error}
                </div>
              )}

              <button
                style={{ ...styles.button('primary'), width: '100%' }}
                onClick={handleSubmit}
                disabled={loading || !jobDescription || resumeFiles.length === 0}
              >
                {loading ? 'Analyzing...' : <>Analyze Match ({resumeFiles.length}) <Icons.ChevronRight /></>}
              </button>
            </div>

            <div style={styles.card} className="animate-in delay-2">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-blue)')}>
                  <Icons.Award />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Analysis Results</h3>
                  <p style={styles.cardDescription}>AI-generated score and insights</p>
                </div>
              </div>

              {results ? (
                <div style={{ display: 'flex', flexDirection: 'column', gap: '24px' }}>
                  {results.map((result, idx) => (
                    <div key={idx} style={{
                      padding: '20px',
                      border: '1px solid var(--border-color)',
                      borderRadius: '12px',
                      background: 'var(--bg-secondary)'
                    }}>
                      {result.filename && (
                        <div style={{
                          fontWeight: '600',
                          marginBottom: '16px',
                          paddingBottom: '8px',
                          borderBottom: '1px solid var(--border-color)'
                        }}>
                          {result.filename}
                        </div>
                      )}
                      <div style={{ textAlign: 'center' }}>
                        <ScoreCircle score={result.score} />
                        <p style={{ marginTop: '16px', lineHeight: '1.6', color: 'var(--text-primary)', textAlign: 'left', fontSize: '14px' }}>
                          {result.explanation}
                        </p>
                      </div>
                    </div>
                  ))}
                </div>
              ) : (
                <div style={{ textAlign: 'center', padding: '60px 20px', color: 'var(--text-muted)' }}>
                  <div style={{ marginBottom: '16px', opacity: 0.5 }}>
                    <Icons.BarChart />
                  </div>
                  <p>Results will appear here after analysis</p>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }



    // Job Description Generator Page
    function JDGeneratorPage() {
      const [formData, setFormData] = useState({
        job_title: '',
        company_name: '',
        key_responsibilities: '',
        required_skills: '',
        experience_level: '',
        location: '',
        extra_details: '',
      });
      const [loading, setLoading] = useState(false);
      const [posting, setPosting] = useState(false);
      const [result, setResult] = useState(null);
      const [error, setError] = useState(null);
      const [copied, setCopied] = useState(false);
      const [posted, setPosted] = useState(false);

      const handleChange = (field, value) => {
        setFormData(prev => ({ ...prev, [field]: value }));
      };

      const handleSubmit = async () => {
        if (!formData.job_title || !formData.company_name) return;

        setLoading(true);
        setError(null);
        setPosted(false);

        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/create_job_description/`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData),
          });

          if (!response.ok) throw new Error('Failed to generate job description');

          const data = await response.json();
          setResult(data.job_description);
        } catch (err) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      const handleCopy = () => {
        navigator.clipboard.writeText(result);
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      };

      const handlePostJob = async () => {
        if (!result || !formData.job_title || !formData.company_name) return;

        setPosting(true);
        setError(null);

        try {
          const postData = new FormData();
          postData.append('title', formData.job_title);
          postData.append('company_name', formData.company_name);
          postData.append('description', result);
          postData.append('experience_level', formData.experience_level || '');
          postData.append('location', formData.location || '');
          postData.append('responsibilities', formData.key_responsibilities || '');
          postData.append('skills', formData.required_skills || '');

          const token = localStorage.getItem('token');
          if (token) {
            postData.append('token', token);
          }

          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/from-jd/`, {
            method: 'POST',
            body: postData,
          });

          if (!response.ok) throw new Error('Failed to post job');

          const data = await response.json();
          if (data.success) {
            setPosted(true);
            setTimeout(() => setPosted(false), 3000);
          }
        } catch (err) {
          setError(err.message);
        } finally {
          setPosting(false);
        }
      };

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-blue)' }}>JD</span> Generator
            </h1>
            <p style={styles.pageSubtitle}>
              Create professional, engaging job descriptions in seconds with AI-powered generation.
            </p>
          </div>

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-blue)')}>
                  <Icons.Briefcase />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Role Details</h3>
                  <p style={styles.cardDescription}>Enter the job specifications</p>
                </div>
              </div>

              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Job Title *</label>
                  <input
                    style={styles.input}
                    placeholder="e.g., Senior Python Developer"
                    value={formData.job_title}
                    onChange={(e) => handleChange('job_title', e.target.value)}
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Company Name *</label>
                  <input
                    style={styles.input}
                    placeholder="e.g., Innovatech Solutions"
                    value={formData.company_name}
                    onChange={(e) => handleChange('company_name', e.target.value)}
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>
              </div>

              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Experience Level</label>
                  <select
                    style={styles.select}
                    value={formData.experience_level}
                    onChange={(e) => handleChange('experience_level', e.target.value)}
                  >
                    <option value="">Select level</option>
                    <option value="Entry Level (0-2 years)">Entry Level (0-2 years)</option>
                    <option value="Mid Level (2-5 years)">Mid Level (2-5 years)</option>
                    <option value="Senior Level (5-8 years)">Senior Level (5-8 years)</option>
                    <option value="Lead/Principal (8+ years)">Lead/Principal (8+ years)</option>
                  </select>
                </div>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Location</label>
                  <input
                    style={styles.input}
                    placeholder="e.g., Remote, Bangalore, Hybrid"
                    value={formData.location}
                    onChange={(e) => handleChange('location', e.target.value)}
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Key Responsibilities</label>
                <textarea
                  style={{ ...styles.textarea, minHeight: '100px' }}
                  placeholder="List the main responsibilities separated by semicolons or commas..."
                  value={formData.key_responsibilities}
                  onChange={(e) => handleChange('key_responsibilities', e.target.value)}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Required Skills</label>
                <textarea
                  style={{ ...styles.textarea, minHeight: '100px' }}
                  placeholder="List required skills separated by semicolons or commas..."
                  value={formData.required_skills}
                  onChange={(e) => handleChange('required_skills', e.target.value)}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Additional Details</label>
                <textarea
                  style={{ ...styles.textarea, minHeight: '80px' }}
                  placeholder="Any other requirements or preferences..."
                  value={formData.extra_details}
                  onChange={(e) => handleChange('extra_details', e.target.value)}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-blue)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
              </div>

              <button
                style={{
                  ...styles.button('primary'),
                  width: '100%',
                  background: 'linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-purple) 100%)',
                  opacity: (!formData.job_title || !formData.company_name || loading) ? 0.5 : 1,
                  cursor: (!formData.job_title || !formData.company_name || loading) ? 'not-allowed' : 'pointer',
                }}
                onClick={handleSubmit}
                disabled={!formData.job_title || !formData.company_name || loading}
              >
                {loading ? <Spinner size={18} /> : <Icons.Sparkles />}
                {loading ? 'Generating...' : 'Generate Job Description'}
              </button>

              {error && (
                <div style={{
                  marginTop: '16px',
                  padding: '12px 16px',
                  background: 'rgba(239, 68, 68, 0.1)',
                  borderRadius: '8px',
                  color: 'var(--danger)',
                  fontSize: '14px'
                }}>
                  {error}
                </div>
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                <div style={styles.cardHeader}>
                  <div style={styles.cardIcon('var(--accent-purple)')}>
                    <Icons.FileText />
                  </div>
                  <div>
                    <h3 style={styles.cardTitle}>Generated JD</h3>
                    <p style={styles.cardDescription}>Your professional job description</p>
                  </div>
                </div>
                {result && (
                  <div style={{ display: 'flex', gap: '8px' }}>
                    <button
                      style={{ ...styles.button('secondary'), padding: '10px 16px' }}
                      onClick={handleCopy}
                    >
                      {copied ? <Icons.Check /> : <Icons.Copy />}
                      {copied ? 'Copied!' : 'Copy'}
                    </button>
                    <button
                      style={{
                        ...styles.button('primary'),
                        padding: '10px 16px',
                        background: posted ? 'var(--success)' : 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%)',
                        opacity: posting ? 0.7 : 1,
                      }}
                      onClick={handlePostJob}
                      disabled={posting || posted}
                    >
                      {posting ? <Spinner size={16} /> : posted ? <Icons.Check /> : <Icons.Briefcase />}
                      {posting ? 'Posting...' : posted ? 'Posted!' : 'Post Job'}
                    </button>
                  </div>
                )}
              </div>

              {result ? (
                <div>
                  <div style={{
                    background: 'var(--bg-secondary)',
                    borderRadius: '12px',
                    padding: '24px',
                    maxHeight: '500px',
                    overflow: 'auto',
                    whiteSpace: 'pre-wrap',
                    fontSize: '14px',
                    lineHeight: '1.8',
                  }}>
                    {result}
                  </div>
                  {posted && (
                    <div style={{
                      marginTop: '16px',
                      padding: '12px 16px',
                      background: 'rgba(34, 197, 94, 0.1)',
                      borderRadius: '8px',
                      color: 'var(--success)',
                      fontSize: '14px',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '8px'
                    }}>
                      <Icons.Check /> Job posted successfully! Candidates can now view and apply.
                    </div>
                  )}
                </div>
              ) : (
                <div style={{ textAlign: 'center', padding: '60px 20px', color: 'var(--text-muted)' }}>
                  <div style={{ marginBottom: '16px', opacity: 0.5 }}>
                    <Icons.FileText />
                  </div>
                  <p>Fill in the details to generate a job description</p>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    // Voice Agent Page
    function VoiceAgentPage() {
      const [isConnected, setIsConnected] = useState(false);
      const [isListening, setIsListening] = useState(false); // Controls mic mute/unmute
      const [transcript, setTranscript] = useState([]);
      const [status, setStatus] = useState('idle'); // idle, connecting, connected, error
      const [error, setError] = useState(null);
      const audioRef = useRef(null);
      const peerConnectionRef = useRef(null);
      const dataChannelRef = useRef(null);
      const streamRef = useRef(null); // Local media stream
      const user = JSON.parse(localStorage.getItem('user') || '{}');

      // Cleanup on unmount
      useEffect(() => {
        return () => {
          handleEndCall();
        };
      }, []);

      const getEphemeralToken = async () => {
        try {
          const formData = new FormData();
          formData.append('candidate_name', user.full_name || 'Candidate');

          const response = await fetch(`${API_CONFIG.BASE_URL}/realtime/session/`, {
            method: 'POST',
            body: formData,
          });

          if (!response.ok) throw new Error('Failed to get session token');

          const data = await response.json();
          if (!data.success) throw new Error(data.message);

          return data.session.client_secret.value;
        } catch (err) {
          console.error("Token Error:", err);
          throw new Error("Could not start interview session. Contact HR.");
        }
      };

      const handleStartCall = async () => {
        try {
          setStatus('connecting');
          setError(null);

          // 1. Get Ephemeral Token
          const ephemeralToken = await getEphemeralToken();

          // 2. Setup WebRTC Peer Connection
          const pc = new RTCPeerConnection();
          peerConnectionRef.current = pc;

          // Setup remote audio
          pc.ontrack = (event) => {
            if (audioRef.current) {
              audioRef.current.srcObject = event.streams[0];
            }
          };

          // Setup Data Channel for events
          const dc = pc.createDataChannel("oai-events");
          dataChannelRef.current = dc;

          dc.onopen = () => {
            console.log("Data channel open");
            const responseCreate = {
              type: "response.create",
              response: {
                modalities: ["audio", "text"],
                instructions: `Start the interview now. The user is ${user.full_name || 'the candidate'}. Say hello properly.`
              }
            };
            dc.send(JSON.stringify(responseCreate));
          };

          dc.onmessage = (e) => {
            try {
              const event = JSON.parse(e.data);
              if (event.type === 'response.audio_transcript.done') {
                setTranscript(prev => [...prev, { role: 'assistant', content: event.transcript }]);
              } else if (event.type === 'conversation.item.input_audio_transcription.completed') {
                setTranscript(prev => [...prev, { role: 'user', content: event.transcript }]);
              }
            } catch (err) {
              console.error("Event error", err);
            }
          };

          // 3. Get Microphone Audio
          const ms = await navigator.mediaDevices.getUserMedia({ audio: true });
          streamRef.current = ms;
          pc.addTrack(ms.getTracks()[0]);

          // 4. Create Offer & Set Local Description
          const offer = await pc.createOffer();
          await pc.setLocalDescription(offer);

          // 5. Connect to OpenAI Realtime API
          const baseUrl = "https://api.openai.com/v1/realtime";
          const model = "gpt-4o-realtime-preview-2024-12-17";

          const response = await fetch(`${baseUrl}?model=${model}`, {
            method: "POST",
            body: offer.sdp,
            headers: {
              "Authorization": `Bearer ${ephemeralToken}`,
              "Content-Type": "application/sdp"
            },
          });

          if (!response.ok) throw new Error(`OpenAI Connection failed: ${response.statusText}`);

          // 6. Set Remote Description (Answer)
          const answerSdp = await response.text();
          await pc.setRemoteDescription({ type: "answer", sdp: answerSdp });

          setIsConnected(true);
          setIsListening(true);
          setStatus('connected');

        } catch (err) {
          console.error("Connection Error:", err);
          setError(err.message);
          setStatus('error');
          handleEndCall();
        }
      };

      const handleEndCall = () => {
        if (peerConnectionRef.current) {
          peerConnectionRef.current.close();
          peerConnectionRef.current = null;
        }
        if (streamRef.current) {
          streamRef.current.getTracks().forEach(track => track.stop());
          streamRef.current = null;
        }
        if (audioRef.current) {
          audioRef.current.srcObject = null;
        }
        setIsConnected(false);
        setIsListening(false);
        setStatus('idle');
      };

      const toggleMic = () => {
        if (streamRef.current) {
          const audioTrack = streamRef.current.getAudioTracks()[0];
          audioTrack.enabled = !audioTrack.enabled;
          setIsListening(audioTrack.enabled);
        }
      };

      return (
        <div>
          <audio ref={audioRef} autoPlay />

          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-purple)' }}>Voice</span> Interview Agent
            </h1>
            <p style={styles.pageSubtitle}>
              AI-powered voice screening calls. Please find a quiet place before starting.
            </p>
          </div>

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              {!isConnected ? (
                <div style={{ padding: '40px', textAlign: 'center' }}>
                  <div style={{
                    width: '80px', height: '80px', borderRadius: '50%',
                    background: 'var(--bg-tertiary)', display: 'flex',
                    alignItems: 'center', justifyContent: 'center',
                    margin: '0 auto 24px', color: 'var(--accent-purple)'
                  }}>
                    <Icons.Mic />
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '12px' }}>Ready for your interview?</h2>
                  <p style={{ color: 'var(--text-secondary)', marginBottom: '32px', maxWidth: '400px', margin: '0 auto 32px' }}>
                    The AI interviewer will ask you questions about your background and experience.
                    Speak naturally and clearly. The session will be recorded for HR review.
                  </p>

                  {error && (
                    <div style={{
                      padding: '12px', background: 'rgba(239, 68, 68, 0.1)',
                      color: 'var(--danger)', borderRadius: '8px', marginBottom: '24px',
                      fontSize: '14px'
                    }}>
                      {error}
                    </div>
                  )}

                  <button
                    style={{
                      ...styles.button('primary'),
                      padding: '16px 48px',
                      fontSize: '18px',
                      background: 'linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%)',
                      opacity: status === 'connecting' ? 0.7 : 1,
                      cursor: status === 'connecting' ? 'not-allowed' : 'pointer'
                    }}
                    onClick={handleStartCall}
                    disabled={status === 'connecting'}
                  >
                    {status === 'connecting' ? 'Connecting...' : <span>Start Interview</span>}
                  </button>
                </div>
              ) : (
                <div style={styles.voiceAgent}>
                  <div style={{ textAlign: 'center', marginBottom: '24px' }}>
                    <div style={{
                      fontSize: '14px', fontWeight: '600',
                      color: 'var(--success)', display: 'inline-flex',
                      alignItems: 'center', gap: '8px',
                      padding: '6px 12px', background: 'rgba(34, 197, 94, 0.1)',
                      borderRadius: '20px'
                    }}>
                      <div style={{ width: '8px', height: '8px', borderRadius: '50%', background: 'currentColor', animation: 'pulse 1s infinite' }} />
                      Live Interview in Progress
                    </div>
                  </div>

                  <div
                    style={styles.voiceCircle(isListening)}
                    onClick={toggleMic}
                  >
                    {isConnected && (
                      <div style={{
                        position: 'absolute',
                        inset: '-4px',
                        borderRadius: '50%',
                        border: '2px solid var(--accent-primary)',
                        opacity: isListening ? 1 : 0,
                        animation: isListening ? 'ripple 1.5s infinite' : 'none',
                      }} />
                    )}
                    <div style={{ color: isListening ? 'var(--bg-primary)' : 'var(--text-primary)', transform: 'scale(2)' }}>
                      {isListening ? <Icons.Mic /> : <Icons.MicOff />}
                    </div>
                  </div>

                  <div style={{ marginBottom: '24px' }}>
                    <Waveform isActive={isListening} bars={16} />
                    <p style={{ textAlign: 'center', marginTop: '16px', color: 'var(--text-secondary)' }}>
                      {isListening ? 'Listening...' : 'Microphone muted'}
                    </p>
                  </div>

                  <div style={{ display: 'flex', gap: '12px', justifyContent: 'center' }}>
                    <button
                      style={{ ...styles.button('secondary'), color: 'var(--danger)', borderColor: 'var(--danger)' }}
                      onClick={handleEndCall}
                    >
                      <Icons.PhoneOff /> End Interview
                    </button>
                  </div>
                </div>
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-orange)')}>
                  <Icons.FileText />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Live Transcript</h3>
                  <p style={styles.cardDescription}>Real-time conversation log</p>
                </div>
              </div>

              {transcript.length > 0 ? (
                <div style={styles.transcript}>
                  {transcript.map((msg, i) => (
                    <div key={i} style={styles.transcriptMessage(msg.role)}>
                      <div style={{
                        fontSize: '11px',
                        fontWeight: '600',
                        color: msg.role === 'assistant' ? 'var(--accent-blue)' : 'var(--accent-primary)',
                        marginBottom: '6px',
                        textTransform: 'uppercase',
                        letterSpacing: '0.5px'
                      }}>
                        {msg.role === 'assistant' ? 'AI Interviewer' : 'You'}
                      </div>
                      <p style={{ fontSize: '14px', lineHeight: '1.6' }}>{msg.content}</p>
                    </div>
                  ))}
                </div>
              ) : (
                <div style={{ textAlign: 'center', padding: '60px 20px', color: 'var(--text-muted)' }}>
                  <div style={{ marginBottom: '16px', opacity: 0.5 }}>
                    <Icons.FileText />
                  </div>
                  <p>Transcript will appear here during the call</p>
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }


    // Candidates Page
    // Candidates Page
    // Candidates Page
    // Candidates Page
    function CandidatesPage() {
      const [selectedCandidate, setSelectedCandidate] = useState(null);
      const [filter, setFilter] = useState('pending'); // Default to pending (Inbox)
      const [candidates, setCandidates] = useState([]);
      const [loading, setLoading] = useState(true);
      const [actionLoading, setActionLoading] = useState(false);

      useEffect(() => {
        fetchCandidates();
      }, []);

      const fetchCandidates = async () => {
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/candidates/`);
          const data = await response.json();
          const mapped = (data.candidates || []).map(app => ({
            id: app.id,
            name: app.candidate_name,
            role: app.job_role || 'Applicant',
            score: app.score,
            status: app.status,
            interviewed: false,
            resumeUrl: app.resume_url
          }));
          setCandidates(mapped);
        } catch (e) {
          console.error("Candidates error", e);
        } finally {
          setLoading(false);
        }
      };

      const handleStatusUpdate = async (candidateId, newStatus) => {
        setActionLoading(true);
        try {
          const formData = new FormData();
          formData.append('status', newStatus);

          const response = await fetch(`${API_CONFIG.BASE_URL}/candidates/${candidateId}/status/`, {
            method: 'PUT',
            body: formData
          });

          if (response.ok) {
            // Update local state
            setCandidates(prev => prev.map(c =>
              c.id === candidateId ? { ...c, status: newStatus } : c
            ));

            // Deselect if moved out of current view
            if (filter !== 'all' && newStatus !== filter) {
              setSelectedCandidate(null);
            } else {
              // Update selected candidate status reference
              setSelectedCandidate(prev => ({ ...prev, status: newStatus }));
            }
          }
        } catch (err) {
          console.error("Failed to update status", err);
        } finally {
          setActionLoading(false);
        }
      };

      const filteredCandidates = candidates.filter(c => filter === 'all' || c.status === filter);

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading candidates...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-orange)' }}>Candidate</span> Pipeline
            </h1>
            <p style={styles.pageSubtitle}>
              Review and manage your candidate pool with AI-generated insights and recommendations.
            </p>
          </div>

          <Tabs
            tabs={[
              { id: 'pending', label: 'Inbox / New' },
              { id: 'shortlisted', label: 'Shortlisted' },
              { id: 'rejected', label: 'Rejected' },
              { id: 'all', label: 'All Candidates' },
            ]}
            activeTab={filter}
            onChange={setFilter}
          />

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-orange)')}>
                  <Icons.Users />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Candidates ({filteredCandidates.length})</h3>
                  <p style={styles.cardDescription}>Click to view detailed profile</p>
                </div>
              </div>

              {filteredCandidates.length === 0 ? (
                <div style={{ padding: '40px', textAlign: 'center', color: 'var(--text-secondary)' }}>
                  No candidates found in this section.
                </div>
              ) : (
                filteredCandidates.map((candidate) => (
                  <div
                    key={candidate.id}
                    style={{
                      ...styles.candidateCard,
                      borderColor: selectedCandidate?.id === candidate.id ? 'var(--accent-primary)' : 'transparent',
                    }}
                    onClick={() => setSelectedCandidate(candidate)}
                  >
                    <div style={styles.avatar}>
                      {candidate.name.split(' ').map(n => n[0]).join('')}
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '600', marginBottom: '2px' }}>{candidate.name}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{candidate.role}</div>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <div style={{
                        fontWeight: '700',
                        fontSize: '18px',
                        color: candidate.score >= 70 ? 'var(--success)' : candidate.score >= 50 ? 'var(--warning)' : 'var(--danger)',
                        marginBottom: '4px'
                      }}>
                        {candidate.score}%
                      </div>
                      <span style={styles.statusBadge(candidate.status === 'shortlisted' ? 'completed' : candidate.status === 'rejected' ? 'failed' : 'pending')}>
                        {candidate.status}
                      </span>
                    </div>
                  </div>
                ))
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              {selectedCandidate ? (
                <>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '20px', marginBottom: '24px' }}>
                    <div style={{ ...styles.avatar, width: '72px', height: '72px', fontSize: '24px' }}>
                      {selectedCandidate.name.split(' ').map(n => n[0]).join('')}
                    </div>
                    <div>
                      <h3 style={{ fontSize: '24px', fontWeight: '600', marginBottom: '4px' }}>{selectedCandidate.name}</h3>
                      <div style={{ color: 'var(--text-secondary)' }}>{selectedCandidate.role}</div>

                      {selectedCandidate.resumeUrl && (
                        <a
                          href={selectedCandidate.resumeUrl}
                          target="_blank"
                          rel="noopener noreferrer"
                          style={{
                            display: 'inline-flex',
                            alignItems: 'center',
                            gap: '6px',
                            marginTop: '8px',
                            background: 'rgba(0, 212, 170, 0.1)',
                            color: 'var(--accent-primary)',
                            padding: '6px 12px',
                            borderRadius: '6px',
                            fontSize: '13px',
                            fontWeight: '500',
                            textDecoration: 'none',
                            transition: 'background 0.2s',
                            cursor: 'pointer'
                          }}
                          onMouseEnter={(e) => e.target.style.background = 'rgba(0, 212, 170, 0.2)'}
                          onMouseLeave={(e) => e.target.style.background = 'rgba(0, 212, 170, 0.1)'}
                        >
                          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="7,10 12,15 17,10" />
                            <line x1="12" y1="15" x2="12" y2="3" />
                          </svg>
                          View Resume
                        </a>
                      )}
                    </div>
                  </div>

                  {/* ACTION BUTTONS */}
                  <div style={{ display: 'flex', gap: '12px', marginBottom: '24px' }}>
                    <button
                      onClick={() => handleStatusUpdate(selectedCandidate.id, 'shortlisted')}
                      disabled={actionLoading || selectedCandidate.status === 'shortlisted'}
                      style={{
                        flex: 1,
                        padding: '12px',
                        borderRadius: '8px',
                        border: 'none',
                        background: selectedCandidate.status === 'shortlisted' ? 'var(--success)' : 'var(--bg-tertiary)',
                        color: selectedCandidate.status === 'shortlisted' ? 'white' : 'var(--success)',
                        fontWeight: '600',
                        cursor: actionLoading ? 'wait' : 'pointer',
                        transition: 'all 0.2s'
                      }}
                    >
                      {selectedCandidate.status === 'shortlisted' ? 'Shortlisted' : 'Shortlist'}
                    </button>
                    <button
                      onClick={() => handleStatusUpdate(selectedCandidate.id, 'rejected')}
                      disabled={actionLoading || selectedCandidate.status === 'rejected'}
                      style={{
                        flex: 1,
                        padding: '12px',
                        borderRadius: '8px',
                        border: 'none',
                        background: selectedCandidate.status === 'rejected' ? 'var(--danger)' : 'var(--bg-tertiary)',
                        color: selectedCandidate.status === 'rejected' ? 'white' : 'var(--danger)',
                        fontWeight: '600',
                        cursor: actionLoading ? 'wait' : 'pointer',
                        transition: 'all 0.2s'
                      }}
                    >
                      {selectedCandidate.status === 'rejected' ? 'Rejected' : 'Reject'}
                    </button>
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
                    <div style={styles.configSection}>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)', marginBottom: '8px' }}>Match Score</div>
                      <div style={{ fontSize: '32px', fontWeight: '700', color: selectedCandidate.score >= 70 ? 'var(--success)' : 'var(--warning)' }}>
                        {selectedCandidate.score}%
                      </div>
                      <div style={{ ...styles.progressBar, marginTop: '12px' }}>
                        <div style={styles.progressFill(selectedCandidate.score, selectedCandidate.score >= 70 ? 'var(--success)' : 'var(--warning)')} />
                      </div>
                    </div>
                  </div>

                  <div style={styles.resultCard}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                      AI Assessment Summary
                    </div>
                    <p style={{ fontSize: '14px', lineHeight: '1.7' }}>
                      Candidate scored {selectedCandidate.score}%. Review full details in the match report.
                    </p>
                  </div>
                </>
              ) : (
                <div style={{ textAlign: 'center', padding: '100px 20px', color: 'var(--text-muted)' }}>
                  Select a candidate to view details
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    // Bulk Email Page
    function BulkEmailPage() {
      const [candidates, setCandidates] = useState([]);
      const [selectedEmails, setSelectedEmails] = useState([]);
      const [subject, setSubject] = useState('Interview Invitation');
      const [htmlContent, setHtmlContent] = useState('Dear Candidate,\n\nWe are pleased to invite you for an interview.\n\nBest Regards,\nHR Team');
      const [loading, setLoading] = useState(false);
      const [sending, setSending] = useState(false);
      const [results, setResults] = useState(null);

      // Optional Sender Creds
      const [senderEmail, setSenderEmail] = useState('');
      const [appPassword, setAppPassword] = useState('');

      const [manualEmails, setManualEmails] = useState('');

      useEffect(() => {
        fetchCandidates();
      }, []);

      const fetchCandidates = async () => {
        setLoading(true);
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/candidates/`);
          const data = await response.json();
          // Filter out candidates without email if necessary
          const validCandidates = (data.candidates || []).filter(c => c.candidate_email);
          setCandidates(validCandidates);
        } catch (e) {
          console.error("Candidates error", e);
        } finally {
          setLoading(false);
        }
      };

      const toggleCandidate = (email) => {
        if (selectedEmails.includes(email)) {
          setSelectedEmails(prev => prev.filter(e => e !== email));
        } else {
          if (selectedEmails.length >= 10) {
            alert("You can only select up to 10 candidates.");
            return;
          }
          setSelectedEmails(prev => [...prev, email]);
        }
      };

      const handleSend = async () => {
        // Parse manual emails
        const manualEmailList = manualEmails
          .split(/[\s,]+/)
          .map(e => e.trim())
          .filter(e => e && e.includes('@'));

        const allRecipients = [...new Set([...selectedEmails, ...manualEmailList])];

        if (allRecipients.length === 0) {
          alert("Please select candidates or enter email addresses.");
          return;
        }

        if (allRecipients.length > 20) { // Safety limit
          alert("You can send max 20 emails at a time.");
          return;
        }

        setSending(true);
        setResults(null);
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/email/bulk/`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              candidate_emails: allRecipients,
              subject: subject,
              html_content: htmlContent,
              sender_email: senderEmail || undefined,
              app_password: appPassword || undefined
            })
          });
          const data = await response.json();
          setResults(data.results);
        } catch (e) {
          console.error("Email error", e);
          alert("Failed to send emails");
        } finally {
          setSending(false);
        }
      };

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Bulk</span> Email
            </h1>
            <p style={styles.pageSubtitle}>
              Send emails to candidates or manual recipients.
            </p>
          </div>

          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
            {/* Candidate Selection */}
            <div style={styles.card} className="animate-in delay-1">
              <h3 style={{ ...styles.cardTitle, marginBottom: '16px' }}>Select Candidates ({selectedEmails.length})</h3>
              <div style={{ maxHeight: '300px', overflowY: 'auto', marginBottom: '16px', borderBottom: '1px solid var(--border-color)', paddingBottom: '16px' }}>
                {loading ? <p>Loading...</p> : candidates.length > 0 ? candidates.map(c => (
                  <div key={c.id} style={{
                    display: 'flex', alignItems: 'center', padding: '8px',
                    borderBottom: '1px solid var(--border-color)',
                    gap: '12px'
                  }}>
                    <input
                      type="checkbox"
                      checked={selectedEmails.includes(c.candidate_email)}
                      onChange={() => toggleCandidate(c.candidate_email)}
                      style={{ width: '16px', height: '16px', cursor: 'pointer' }}
                    />
                    <div>
                      <div style={{ fontWeight: '500' }}>{c.candidate_name}</div>
                      <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>{c.candidate_email}</div>
                    </div>
                  </div>
                )) : <p style={{ color: 'var(--text-muted)' }}>No candidates found in database.</p>}
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Or Enter Manual Emails (comma separated)</label>
                <textarea
                  style={{ ...styles.textarea, height: '80px' }}
                  placeholder="john@example.com, jane@test.com (comma, space or new line separated)"
                  value={manualEmails}
                  onChange={e => setManualEmails(e.target.value)}
                />
              </div>
            </div>

            {/* Email Form */}
            <div style={styles.card} className="animate-in delay-2">
              <h3 style={{ ...styles.cardTitle, marginBottom: '16px' }}>Compose Email</h3>

              <div style={{ marginBottom: '20px', padding: '16px', background: 'var(--bg-tertiary)', borderRadius: '8px' }}>
                <h4 style={{ fontSize: '14px', marginBottom: '12px', color: 'var(--text-secondary)' }}>Sender Configuration (Optional)</h4>
                <div style={{ display: 'grid', gap: '12px' }}>
                  <input
                    style={styles.input}
                    placeholder="Sender Email (e.g. hr@company.com)"
                    value={senderEmail}
                    onChange={e => setSenderEmail(e.target.value)}
                  />
                  <input
                    style={styles.input}
                    type="password"
                    placeholder="App Password (if using Gmail)"
                    value={appPassword}
                    onChange={e => setAppPassword(e.target.value)}
                  />
                  <div style={{ fontSize: '11px', color: 'var(--text-muted)' }}>
                    Leave blank to use server defaults. Gmail requires an App Password, not your login password.
                  </div>

                  <details style={{ fontSize: '12px', color: 'var(--text-secondary)', marginTop: '4px', cursor: 'pointer' }}>
                    <summary style={{ outline: 'none' }}>How to generate a Gmail App Password?</summary>
                    <ol style={{ paddingLeft: '20px', marginTop: '8px', lineHeight: '1.6', color: 'var(--text-primary)' }}>
                      <li>Go to your <a href="https://myaccount.google.com/" target="_blank" rel="noopener noreferrer" style={{ color: 'var(--accent-primary)' }}>Google Account</a> settings.</li>
                      <li>Select <strong>Security</strong> from the left panel.</li>
                      <li>Under "Signing in to Google," enable <strong>2-Step Verification</strong> if (OFF).</li>
                      <li>Search for <strong>"App passwords"</strong> in the top search bar.</li>
                      <li>Create a new app password (name it "HR App").</li>
                      <li>Copy the 16-character code and paste it here.</li>
                    </ol>
                  </details>
                </div>
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Subject</label>
                <input
                  style={styles.input}
                  value={subject}
                  onChange={e => setSubject(e.target.value)}
                />
              </div>
              <div style={styles.formGroup}>
                <label style={styles.label}>Message</label>
                <textarea
                  style={{ ...styles.textarea, height: '200px', fontFamily: 'inherit' }}
                  value={htmlContent}
                  onChange={e => setHtmlContent(e.target.value)}
                  placeholder="Type your email message here..."
                />
              </div>
              <button
                style={{ ...styles.button('primary'), width: '100%' }}
                onClick={handleSend}
                disabled={sending || (selectedEmails.length === 0 && !manualEmails.trim())}
              >
                {sending ? 'Sending...' : 'Send Emails'} {sending ? <Spinner size={16} /> : <Icons.Mail />}
              </button>

              {results && (
                <div style={{ marginTop: '20px', padding: '10px', background: 'var(--bg-tertiary)', borderRadius: '8px' }}>
                  <h4 style={{ marginBottom: '8px' }}>Results</h4>
                  {results.map((r, i) => (
                    <div key={i} style={{ fontSize: '12px', marginTop: '4px', color: r.status === 'sent' ? 'var(--success)' : 'var(--danger)' }}>
                      <strong>{r.email}</strong>: {r.status} {r.error ? `(${r.error})` : ''}
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    // Job Applications Page (HR Admin)
    function JobApplicationsPage() {
      const [applications, setApplications] = useState([]);
      const [jobs, setJobs] = useState([]);
      const [selectedApp, setSelectedApp] = useState(null);
      const [filter, setFilter] = useState('pending');
      const [loading, setLoading] = useState(true);
      const [actionLoading, setActionLoading] = useState(false);

      useEffect(() => {
        fetchData();
      }, []);

      const fetchData = async () => {
        try {
          const [appsRes, jobsRes] = await Promise.all([
            fetch(`${API_CONFIG.BASE_URL}/job-applications/`),
            fetch(`${API_CONFIG.BASE_URL}/jobs/`)
          ]);
          const appsData = await appsRes.json();
          const jobsData = await jobsRes.json();
          setApplications(appsData.applications || []);
          setJobs(jobsData.jobs || []);
        } catch (e) {
          console.error("Applications error", e);
        } finally {
          setLoading(false);
        }
      };

      const handleStatusUpdate = async (appId, newStatus) => {
        setActionLoading(true);
        try {
          const formData = new FormData();
          formData.append('status', newStatus);

          const response = await fetch(`${API_CONFIG.BASE_URL}/job-applications/${appId}/status/`, {
            method: 'PUT',
            body: formData
          });

          if (response.ok) {
            setApplications(prev => prev.map(a =>
              a.id === appId ? { ...a, status: newStatus } : a
            ));
            if (selectedApp?.id === appId) {
              setSelectedApp(prev => ({ ...prev, status: newStatus }));
            }
          }
        } catch (err) {
          console.error("Failed to update status", err);
        } finally {
          setActionLoading(false);
        }
      };

      const filteredApps = applications.filter(a => filter === 'all' || a.status === filter);

      const statusColors = {
        pending: 'var(--warning)',
        reviewed: 'var(--accent-blue)',
        shortlisted: 'var(--success)',
        rejected: 'var(--danger)',
        hired: 'var(--accent-purple)'
      };

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading applications...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-purple)' }}>Job</span> Applications
            </h1>
            <p style={styles.pageSubtitle}>
              Review applications submitted by candidates for your job postings.
            </p>
          </div>

          {/* Stats */}
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '16px', marginBottom: '24px' }}>
            {[
              { label: 'Total', count: applications.length, color: 'var(--text-primary)' },
              { label: 'Pending', count: applications.filter(a => a.status === 'pending').length, color: 'var(--warning)' },
              { label: 'Reviewed', count: applications.filter(a => a.status === 'reviewed').length, color: 'var(--accent-blue)' },
              { label: 'Shortlisted', count: applications.filter(a => a.status === 'shortlisted').length, color: 'var(--success)' },
              { label: 'Hired', count: applications.filter(a => a.status === 'hired').length, color: 'var(--accent-purple)' },
            ].map(stat => (
              <div key={stat.label} style={{
                background: 'var(--bg-card)',
                borderRadius: '12px',
                padding: '16px',
                border: '1px solid var(--border-color)',
                textAlign: 'center'
              }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: stat.color }}>{stat.count}</div>
                <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>{stat.label}</div>
              </div>
            ))}
          </div>

          <Tabs
            tabs={[
              { id: 'pending', label: 'Pending' },
              { id: 'reviewed', label: 'Reviewed' },
              { id: 'shortlisted', label: 'Shortlisted' },
              { id: 'rejected', label: 'Rejected' },
              { id: 'hired', label: 'Hired' },
              { id: 'all', label: 'All' },
            ]}
            activeTab={filter}
            onChange={setFilter}
          />

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-purple)')}>
                  <Icons.FileText />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Applications ({filteredApps.length})</h3>
                  <p style={styles.cardDescription}>Click to view details</p>
                </div>
              </div>

              {filteredApps.length === 0 ? (
                <div style={{ padding: '40px', textAlign: 'center', color: 'var(--text-secondary)' }}>
                  No applications in this category.
                </div>
              ) : (
                filteredApps.map((app) => (
                  <div
                    key={app.id}
                    style={{
                      ...styles.candidateCard,
                      borderColor: selectedApp?.id === app.id ? 'var(--accent-purple)' : 'transparent',
                    }}
                    onClick={() => setSelectedApp(app)}
                  >
                    <div style={styles.avatar}>
                      {app.candidate_name.split(' ').map(n => n[0]).join('')}
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '600', marginBottom: '2px' }}>{app.candidate_name}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{app.job_title || 'Unknown Job'}</div>
                      <div style={{ fontSize: '12px', color: 'var(--text-muted)' }}>{app.company_name}</div>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <span style={{
                        display: 'inline-block',
                        padding: '4px 12px',
                        fontSize: '12px',
                        fontWeight: '600',
                        color: statusColors[app.status],
                        background: `${statusColors[app.status]}15`,
                        borderRadius: '20px',
                      }}>
                        {app.status}
                      </span>
                      <div style={{ fontSize: '11px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        {new Date(app.created_at).toLocaleDateString()}
                      </div>
                    </div>
                  </div>
                ))
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              {selectedApp ? (
                <>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '20px', marginBottom: '24px' }}>
                    <div style={{ ...styles.avatar, width: '72px', height: '72px', fontSize: '24px' }}>
                      {selectedApp.candidate_name.split(' ').map(n => n[0]).join('')}
                    </div>
                    <div>
                      <h3 style={{ fontSize: '24px', fontWeight: '600', marginBottom: '4px' }}>{selectedApp.candidate_name}</h3>
                      <div style={{ color: 'var(--text-secondary)' }}>{selectedApp.candidate_email}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        Applied for: <strong>{selectedApp.job_title}</strong> at {selectedApp.company_name}
                      </div>
                    </div>
                  </div>

                  {/* Resume Download */}
                  {selectedApp.resume_url && (
                    <a
                      href={selectedApp.resume_url}
                      target="_blank"
                      rel="noopener noreferrer"
                      style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px',
                        padding: '12px 16px',
                        background: 'rgba(139, 92, 246, 0.1)',
                        color: 'var(--accent-purple)',
                        borderRadius: '8px',
                        marginBottom: '20px',
                        textDecoration: 'none',
                        fontWeight: '500',
                      }}
                    >
                      <Icons.Download /> Download Resume
                    </a>
                  )}

                  {/* Cover Letter */}
                  {selectedApp.cover_letter && (
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                        Cover Letter
                      </div>
                      <div style={{
                        background: 'var(--bg-secondary)',
                        padding: '16px',
                        borderRadius: '8px',
                        fontSize: '14px',
                        lineHeight: '1.6',
                        whiteSpace: 'pre-wrap',
                        maxHeight: '200px',
                        overflow: 'auto'
                      }}>
                        {selectedApp.cover_letter}
                      </div>
                    </div>
                  )}

                  {/* Status Actions */}
                  <div style={{ marginBottom: '20px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase' }}>
                      Update Status
                    </div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                      {['pending', 'reviewed', 'shortlisted', 'rejected', 'hired'].map(status => (
                        <button
                          key={status}
                          onClick={() => handleStatusUpdate(selectedApp.id, status)}
                          disabled={actionLoading || selectedApp.status === status}
                          style={{
                            padding: '8px 16px',
                            borderRadius: '8px',
                            border: 'none',
                            background: selectedApp.status === status ? statusColors[status] : 'var(--bg-tertiary)',
                            color: selectedApp.status === status ? 'white' : statusColors[status],
                            fontWeight: '600',
                            fontSize: '13px',
                            cursor: actionLoading ? 'wait' : 'pointer',
                            opacity: selectedApp.status === status ? 1 : 0.8,
                            transition: 'all 0.2s',
                            textTransform: 'capitalize'
                          }}
                        >
                          {status}
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* Application Info */}
                  <div style={styles.resultCard}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                      Application Details
                    </div>
                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', fontSize: '14px' }}>
                      <div>
                        <span style={{ color: 'var(--text-muted)' }}>Applied:</span>{' '}
                        {new Date(selectedApp.created_at).toLocaleString()}
                      </div>
                      <div>
                        <span style={{ color: 'var(--text-muted)' }}>Status:</span>{' '}
                        <span style={{ color: statusColors[selectedApp.status], fontWeight: '600', textTransform: 'capitalize' }}>
                          {selectedApp.status}
                        </span>
                      </div>
                    </div>
                  </div>
                </>
              ) : (
                <div style={{ textAlign: 'center', padding: '100px 20px', color: 'var(--text-muted)' }}>
                  Select an application to view details
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }


    // Job Postings Management Page (HR Admin)
    function JobPostingsManagementPage() {
      const [jobs, setJobs] = useState([]);
      const [selectedJob, setSelectedJob] = useState(null);
      const [filter, setFilter] = useState('active');
      const [loading, setLoading] = useState(true);
      const [actionLoading, setActionLoading] = useState(false);
      const [deleteConfirm, setDeleteConfirm] = useState(null);

      useEffect(() => {
        fetchJobs();
      }, []);

      const fetchJobs = async () => {
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/`);
          const data = await response.json();
          setJobs(data.jobs || []);
        } catch (e) {
          console.error("Jobs error", e);
        } finally {
          setLoading(false);
        }
      };

      const handleStatusUpdate = async (jobId, newStatus) => {
        setActionLoading(true);
        try {
          const formData = new FormData();
          formData.append('status', newStatus);

          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/${jobId}/status/`, {
            method: 'PUT',
            body: formData
          });

          if (response.ok) {
            setJobs(prev => prev.map(j =>
              j.id === jobId ? { ...j, status: newStatus } : j
            ));
            if (selectedJob && selectedJob.id === jobId) {
              setSelectedJob(prev => ({ ...prev, status: newStatus }));
            }
          }
        } catch (err) {
          console.error("Failed to update status", err);
        } finally {
          setActionLoading(false);
        }
      };

      const handleDelete = async (jobId) => {
        setActionLoading(true);
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/${jobId}`, {
            method: 'DELETE'
          });

          if (response.ok) {
            setJobs(prev => prev.filter(j => j.id !== jobId));
            if (selectedJob?.id === jobId) {
              setSelectedJob(null);
            }
            setDeleteConfirm(null);
          }
        } catch (err) {
          console.error("Failed to delete job", err);
        } finally {
          setActionLoading(false);
        }
      };

      const filteredJobs = jobs.filter(j => filter === 'all' || j.status === filter);

      const statusColors = {
        active: 'var(--success)',
        closed: 'var(--danger)',
        draft: 'var(--warning)'
      };

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading job postings...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Job</span> Postings
            </h1>
            <p style={styles.pageSubtitle}>
              Manage your job postings and track their status.
            </p>
          </div>

          {/* Stats */}
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginBottom: '24px' }}>
            {[
              { label: 'Total', count: jobs.length, color: 'var(--text-primary)' },
              { label: 'Active', count: jobs.filter(j => j.status === 'active').length, color: 'var(--success)' },
              { label: 'Closed', count: jobs.filter(j => j.status === 'closed').length, color: 'var(--danger)' },
              { label: 'Draft', count: jobs.filter(j => j.status === 'draft').length, color: 'var(--warning)' },
            ].map(stat => (
              <div key={stat.label} style={{
                background: 'var(--bg-card)',
                borderRadius: '12px',
                padding: '16px',
                border: '1px solid var(--border-color)',
                textAlign: 'center'
              }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: stat.color }}>{stat.count}</div>
                <div style={{ fontSize: '12px', color: 'var(--text-secondary)' }}>{stat.label}</div>
              </div>
            ))}
          </div>

          <Tabs
            tabs={[
              { id: 'active', label: 'Active' },
              { id: 'closed', label: 'Closed' },
              { id: 'draft', label: 'Draft' },
              { id: 'all', label: 'All' },
            ]}
            activeTab={filter}
            onChange={setFilter}
          />

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-primary)')}>
                  <Icons.Briefcase />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Job Listings ({filteredJobs.length})</h3>
                  <p style={styles.cardDescription}>Click to view details</p>
                </div>
              </div>

              {filteredJobs.length === 0 ? (
                <div style={{ padding: '40px', textAlign: 'center', color: 'var(--text-secondary)' }}>
                  No job postings in this category.
                </div>
              ) : (
                filteredJobs.map((job) => (
                  <div
                    key={job.id}
                    style={{
                      ...styles.candidateCard,
                      borderColor: selectedJob?.id === job.id ? 'var(--accent-primary)' : 'transparent',
                    }}
                    onClick={() => setSelectedJob(job)}
                  >
                    <div style={styles.avatar}>
                      <Icons.Briefcase />
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '600', marginBottom: '2px' }}>{job.title}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{job.company_name}</div>
                      <div style={{ fontSize: '12px', color: 'var(--text-muted)' }}>
                        {job.location || 'Location not specified'}
                      </div>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <span style={{
                        display: 'inline-block',
                        padding: '4px 12px',
                        fontSize: '12px',
                        fontWeight: '600',
                        color: statusColors[job.status],
                        background: `${statusColors[job.status]}15`,
                        borderRadius: '20px',
                      }}>
                        {job.status}
                      </span>
                      <div style={{ fontSize: '11px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        {new Date(job.created_at).toLocaleDateString()}
                      </div>
                    </div>
                  </div>
                ))
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              {selectedJob ? (
                <>
                  <div style={{ marginBottom: '24px' }}>
                    <h3 style={{ fontSize: '24px', fontWeight: '600', marginBottom: '8px' }}>{selectedJob.title}</h3>
                    <div style={{ fontSize: '16px', color: 'var(--text-secondary)', marginBottom: '4px' }}>
                      {selectedJob.company_name}
                    </div>
                    <div style={{ fontSize: '14px', color: 'var(--text-muted)' }}>
                      {selectedJob.location || 'Location not specified'}  {selectedJob.experience_level || 'Experience level not specified'}
                    </div>
                  </div>

                  {/* Job Details */}
                  <div style={{ marginBottom: '20px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                      Description
                    </div>
                    <div style={{
                      background: 'var(--bg-secondary)',
                      padding: '16px',
                      borderRadius: '8px',
                      fontSize: '14px',
                      lineHeight: '1.6',
                      whiteSpace: 'pre-wrap',
                      maxHeight: '200px',
                      overflow: 'auto'
                    }}>
                      {selectedJob.description}
                    </div>
                  </div>

                  {selectedJob.responsibilities && (
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                        Responsibilities
                      </div>
                      <div style={{
                        background: 'var(--bg-secondary)',
                        padding: '16px',
                        borderRadius: '8px',
                        fontSize: '14px',
                        lineHeight: '1.6',
                        whiteSpace: 'pre-wrap',
                        maxHeight: '150px',
                        overflow: 'auto'
                      }}>
                        {selectedJob.responsibilities}
                      </div>
                    </div>
                  )}

                  {selectedJob.skills && (
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                        Required Skills
                      </div>
                      <div style={{
                        background: 'var(--bg-secondary)',
                        padding: '16px',
                        borderRadius: '8px',
                        fontSize: '14px',
                        lineHeight: '1.6',
                        whiteSpace: 'pre-wrap',
                        maxHeight: '150px',
                        overflow: 'auto'
                      }}>
                        {selectedJob.skills}
                      </div>
                    </div>
                  )}

                  {/* Status Actions */}
                  <div style={{ marginBottom: '20px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase' }}>
                      Update Status
                    </div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                      {['active', 'closed', 'draft'].map(status => (
                        <button
                          key={status}
                          onClick={() => handleStatusUpdate(selectedJob?.id, status)}
                          disabled={actionLoading || selectedJob?.status === status}
                          style={{
                            padding: '8px 16px',
                            borderRadius: '8px',
                            border: 'none',
                            background: selectedJob?.status === status ? statusColors[status] : 'var(--bg-tertiary)',
                            color: selectedJob?.status === status ? 'white' : statusColors[status],
                            fontWeight: '600',
                            fontSize: '13px',
                            cursor: actionLoading ? 'wait' : 'pointer',
                            opacity: selectedJob?.status === status ? 1 : 0.8,
                            transition: 'all 0.2s',
                            textTransform: 'capitalize'
                          }}
                        >
                          {status}
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* Delete Action */}
                  <div style={{ marginBottom: '20px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase' }}>
                      Actions
                    </div>
                    {deleteConfirm === selectedJob?.id ? (
                      <div style={{
                        background: 'rgba(239, 68, 68, 0.1)',
                        padding: '16px',
                        borderRadius: '8px',
                        border: '1px solid var(--danger)'
                      }}>
                        <div style={{ marginBottom: '12px', fontSize: '14px', fontWeight: '500' }}>
                          Are you sure you want to delete this job posting?
                        </div>
                        <div style={{ display: 'flex', gap: '8px' }}>
                          <button
                            onClick={() => handleDelete(selectedJob?.id)}
                            disabled={actionLoading}
                            style={{
                              padding: '8px 16px',
                              borderRadius: '8px',
                              border: 'none',
                              background: 'var(--danger)',
                              color: 'white',
                              fontWeight: '600',
                              fontSize: '13px',
                              cursor: actionLoading ? 'wait' : 'pointer',
                            }}
                          >
                            {actionLoading ? 'Deleting...' : 'Yes, Delete'}
                          </button>
                          <button
                            onClick={() => setDeleteConfirm(null)}
                            disabled={actionLoading}
                            style={{
                              padding: '8px 16px',
                              borderRadius: '8px',
                              border: '1px solid var(--border-color)',
                              background: 'var(--bg-tertiary)',
                              color: 'var(--text-primary)',
                              fontWeight: '600',
                              fontSize: '13px',
                              cursor: 'pointer',
                            }}
                          >
                            Cancel
                          </button>
                        </div>
                      </div>
                    ) : (
                      <button
                        onClick={() => setDeleteConfirm(selectedJob?.id)}
                        style={{
                          padding: '8px 16px',
                          borderRadius: '8px',
                          border: 'none',
                          background: 'rgba(239, 68, 68, 0.1)',
                          color: 'var(--danger)',
                          fontWeight: '600',
                          fontSize: '13px',
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          gap: '8px'
                        }}
                      >
                        <Icons.Trash /> Delete Job Posting
                      </button>
                    )}
                  </div>

                  {/* Job Info */}
                  <div style={styles.resultCard}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '12px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                      Job Details
                    </div>
                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', fontSize: '14px' }}>
                      <div>
                        <span style={{ color: 'var(--text-muted)' }}>Posted:</span>{' '}
                        {new Date(selectedJob.created_at).toLocaleString()}
                      </div>
                      <div>
                        <span style={{ color: 'var(--text-muted)' }}>Status:</span>{' '}
                        <span style={{ color: statusColors[selectedJob.status], fontWeight: '600', textTransform: 'capitalize' }}>
                          {selectedJob.status}
                        </span>
                      </div>
                    </div>
                  </div>
                </>
              ) : (
                <div style={{ textAlign: 'center', padding: '100px 20px', color: 'var(--text-muted)' }}>
                  Select a job posting to view details
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }


    // Settings Page
    function SettingsPage() {
      const [settings, setSettings] = useState({
        apiBaseUrl: 'http://localhost:8000',
        openaiKey: '',
        mistralKey: '',
        azureEndpoint: '',
        voiceModel: 'alloy',
        autoTranscribe: true,
      });

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--text-secondary)' }}>Settings</span>
            </h1>
            <p style={styles.pageSubtitle}>
              Configure your API connections and application preferences.
            </p>
          </div>

          <div style={{ maxWidth: '800px' }}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-primary)')}>
                  <Icons.Globe />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>API Configuration</h3>
                  <p style={styles.cardDescription}>Connect your backend services</p>
                </div>
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Backend API URL</label>
                <input
                  style={styles.input}
                  placeholder="http://localhost:8000"
                  value={settings.apiBaseUrl}
                  onChange={(e) => setSettings({ ...settings, apiBaseUrl: e.target.value })}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
                <p style={{ fontSize: '12px', color: 'var(--text-muted)', marginTop: '6px' }}>
                  The base URL for your FastAPI backend
                </p>
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>OpenAI API Key</label>
                <input
                  type="password"
                  style={styles.input}
                  placeholder="sk-..."
                  value={settings.openaiKey}
                  onChange={(e) => setSettings({ ...settings, openaiKey: e.target.value })}
                  onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                  onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                />
                <p style={{ fontSize: '12px', color: 'var(--text-muted)', marginTop: '6px' }}>
                  Required for OpenAI Realtime API voice features
                </p>
              </div>

              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Mistral API Key</label>
                  <input
                    type="password"
                    style={styles.input}
                    placeholder="Enter key..."
                    value={settings.mistralKey}
                    onChange={(e) => setSettings({ ...settings, mistralKey: e.target.value })}
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>
                <div style={styles.formGroup}>
                  <label style={styles.label}>Azure Endpoint</label>
                  <input
                    style={styles.input}
                    placeholder="https://..."
                    value={settings.azureEndpoint}
                    onChange={(e) => setSettings({ ...settings, azureEndpoint: e.target.value })}
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>
              </div>
            </div>

            <div style={{ ...styles.card, marginTop: '24px' }} className="animate-in delay-2">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-purple)')}>
                  <Icons.Mic />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Voice Settings</h3>
                  <p style={styles.cardDescription}>Configure the AI voice agent</p>
                </div>
              </div>

              <div style={styles.formGroup}>
                <label style={styles.label}>Voice Model</label>
                <select
                  style={styles.select}
                  value={settings.voiceModel}
                  onChange={(e) => setSettings({ ...settings, voiceModel: e.target.value })}
                >
                  <option value="alloy">Alloy (Balanced)</option>
                  <option value="echo">Echo (Deep)</option>
                  <option value="fable">Fable (Expressive)</option>
                  <option value="onyx">Onyx (Authoritative)</option>
                  <option value="nova">Nova (Friendly)</option>
                  <option value="shimmer">Shimmer (Warm)</option>
                </select>
              </div>

              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '16px', background: 'var(--bg-secondary)', borderRadius: '10px' }}>
                <div>
                  <div style={{ fontWeight: '500', marginBottom: '2px' }}>Auto-transcribe interviews</div>
                  <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>Automatically generate transcripts during calls</div>
                </div>
                <button
                  style={{
                    width: '48px',
                    height: '28px',
                    borderRadius: '14px',
                    border: 'none',
                    cursor: 'pointer',
                    background: settings.autoTranscribe ? 'var(--accent-primary)' : 'var(--bg-tertiary)',
                    position: 'relative',
                    transition: 'all 0.2s ease',
                  }}
                  onClick={() => setSettings({ ...settings, autoTranscribe: !settings.autoTranscribe })}
                >
                  <div style={{
                    width: '20px',
                    height: '20px',
                    borderRadius: '50%',
                    background: 'white',
                    position: 'absolute',
                    top: '4px',
                    left: settings.autoTranscribe ? '24px' : '4px',
                    transition: 'left 0.2s ease',
                  }} />
                </button>
              </div>
            </div>

            <button
              style={{ ...styles.button('primary'), marginTop: '24px' }}
            >
              <Icons.Check /> Save Settings
            </button>
          </div>
        </div>
      );
    }

    // ==================== LANDING PAGE ====================
    function LandingPage({ onLogin, onRegister }) {
      return (
        <div style={{
          minHeight: '100vh',
          background: 'var(--bg-primary)',
          backgroundImage: 'var(--gradient-mesh)',
          color: 'var(--text-primary)',
        }}>
          {/* Landing Header */}
          <header style={{
            padding: '20px 40px',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'space-between',
            maxWidth: '1200px',
            margin: '0 auto',
          }}>
            <div style={styles.logo}>
              <div style={styles.logoIcon}>
                <Icons.Zap />
              </div>
              <span>TalentFlow<span style={{ color: 'var(--accent-primary)' }}>AI</span></span>
            </div>
            <div style={{ display: 'flex', gap: '16px' }}>
              <button
                onClick={onLogin}
                style={{
                  ...styles.button('primary'),
                  padding: '12px 28px',
                  fontSize: '15px',
                }}
              >
                Login <Icons.ChevronRight />
              </button>
            </div>
          </header>

          {/* Hero Section */}
          <section style={{
            textAlign: 'center',
            padding: '80px 20px',
            maxWidth: '900px',
            margin: '0 auto',
          }} className="animate-in">
            <div style={{
              display: 'inline-block',
              padding: '8px 16px',
              borderRadius: '30px',
              background: 'rgba(13, 148, 136, 0.1)',
              color: 'var(--accent-primary)',
              fontWeight: '600',
              fontSize: '14px',
              marginBottom: '24px',
            }}>
               The Future of Recruitment is Here
            </div>
            <h1 style={{
              fontSize: '64px',
              lineHeight: '1.1',
              marginBottom: '24px',
              fontWeight: '700',
              letterSpacing: '-1px',
            }}>
              Hire Smarter with <br />
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Intelligent AI</span> Agents
            </h1>
            <p style={{
              fontSize: '20px',
              color: 'var(--text-secondary)',
              marginBottom: '40px',
              maxWidth: '600px',
              marginLeft: 'auto',
              marginRight: 'auto',
              lineHeight: '1.6',
            }}>
              Automate resume scoring, generate job descriptions, and conduct voice interviewsall in one platform.
            </p>
            <div style={{ display: 'flex', gap: '16px', justifyContent: 'center', marginBottom: '80px' }}>
              <button
                onClick={onLogin}
                style={{
                  ...styles.button('primary'),
                  padding: '16px 32px',
                  fontSize: '18px',
                }}
              >
                Login to Continue
              </button>
              <button
                onClick={() => document.getElementById('features').scrollIntoView({ behavior: 'smooth' })}
                style={{
                  ...styles.button('secondary'),
                  padding: '16px 32px',
                  fontSize: '18px',
                  background: '#fff',
                }}
              >
                Learn More
              </button>
            </div>
          </section>

          {/* Features Section */}
          <section id="features" style={{
            maxWidth: '1200px',
            margin: '0 auto',
            padding: '0 20px 100px',
          }}>
            <div style={styles.grid}>
              {[
                {
                  title: "Resume Scoring",
                  desc: "Instantly score resumes against job descriptions to find the perfect match with detailed insights.",
                  icon: <Icons.FileText />,
                  color: "var(--accent-primary)"
                },
                {
                  title: "Voice Interview Agent",
                  desc: "Conduct first-round screening calls automatically with our human-like AI voice assistant.",
                  icon: <Icons.Mic />,
                  color: "var(--accent-purple)"
                },
                {
                  title: "JD Generator",
                  desc: "Create professional, SEO-optimized job descriptions in seconds by just entering basic details.",
                  icon: <Icons.Briefcase />,
                  color: "var(--accent-blue)"
                },
                {
                  title: "Candidate Pipeline",
                  desc: "Track and manage candidates through every stage of the hiring process with a unified dashboard.",
                  icon: <Icons.Users />,
                  color: "var(--accent-orange)"
                }
              ].map((feature, i) => (
                <div key={i} style={{
                  ...styles.card,
                  padding: '40px',
                  cursor: 'default',
                }} className={`animate-in delay-${i + 1}`}>
                  <div style={{
                    width: '60px',
                    height: '60px',
                    borderRadius: '16px',
                    background: `linear-gradient(135deg, ${feature.color}20 0%, ${feature.color}10 100%)`,
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    color: feature.color,
                    marginBottom: '24px',
                  }}>
                    <div style={{ transform: 'scale(1.5)' }}>{feature.icon}</div>
                  </div>
                  <h3 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '12px' }}>{feature.title}</h3>
                  <p style={{ color: 'var(--text-secondary)', lineHeight: '1.6' }}>{feature.desc}</p>
                </div>
              ))}
            </div>
          </section>
        </div>
      );
    }

    // ==================== LOGIN PAGE ====================
    function LoginPage({ onLogin, onBack }) {
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        setError(null);

        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/auth/login/`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password }),
          });

          const data = await response.json();

          if (data.success) {
            localStorage.setItem('token', data.token);
            localStorage.setItem('user', JSON.stringify(data.user));
            onLogin(data.user, data.token);
          } else {
            setError(data.message || 'Login failed');
          }
        } catch (err) {
          setError('Connection error. Please try again.');
        } finally {
          setLoading(false);
        }
      };

      return (
        <div style={{
          minHeight: '100vh',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          background: 'var(--bg-primary)',
          backgroundImage: 'var(--gradient-mesh)',
          padding: '20px',
        }}>
          {onBack && (
            <button
              onClick={onBack}
              style={{
                position: 'fixed',
                top: '24px',
                left: '24px',
                background: 'none',
                border: 'none',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                color: 'var(--text-secondary)',
                cursor: 'pointer',
                fontWeight: '600',
                zIndex: 10,
              }}
            >
              <span style={{ transform: 'rotate(180deg)', display: 'inline-flex' }}><Icons.ChevronRight /></span>
              Back to Home
            </button>
          )}
          <div style={{
            width: '100%',
            maxWidth: '440px',
            animation: 'fadeInUp 0.6s ease-out',
          }}>
            <div style={{ textAlign: 'center', marginBottom: '40px' }}>
              <div style={{
                width: '64px',
                height: '64px',
                borderRadius: '16px',
                background: 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                margin: '0 auto 20px',
                color: '#ffffff',
              }}>
                <Icons.Zap />
              </div>
              <h1 style={{ fontSize: '32px', fontWeight: '600', marginBottom: '8px', color: 'var(--text-primary)' }}>
                Welcome to <span style={{ color: 'var(--accent-primary)' }}>TalentFlow AI</span>
              </h1>
              <p style={{ color: 'var(--text-secondary)', fontSize: '16px' }}>
                Sign in to access your HR dashboard
              </p>
            </div>

            <div style={{
              ...styles.card,
              boxShadow: '0 4px 24px rgba(0, 0, 0, 0.08)',
            }}>
              <form onSubmit={handleSubmit}>
                {error && (
                  <div style={{
                    padding: '12px 16px',
                    background: 'rgba(239, 68, 68, 0.1)',
                    border: '1px solid var(--danger)',
                    borderRadius: '8px',
                    color: 'var(--danger)',
                    marginBottom: '20px',
                    fontSize: '14px',
                  }}>
                    {error}
                  </div>
                )}

                <div style={styles.formGroup}>
                  <label style={styles.label}>Email Address</label>
                  <input
                    type="email"
                    style={styles.input}
                    placeholder="you@company.com"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>

                <div style={styles.formGroup}>
                  <label style={styles.label}>Password</label>
                  <input
                    type="password"
                    style={styles.input}
                    placeholder=""
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    required
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>

                <button
                  type="submit"
                  style={{
                    ...styles.button('primary'),
                    width: '100%',
                    marginTop: '8px',
                    opacity: loading ? 0.7 : 1,
                  }}
                  disabled={loading}
                >
                  {loading ? <Spinner size={18} /> : 'Sign In'}
                </button>
              </form>

              {/* Contact admin for account creation */}
              <div style={{
                textAlign: 'center',
                marginTop: '24px',
                paddingTop: '24px',
                borderTop: '1px solid var(--border-color)',
              }}>
                <p style={{ color: 'var(--text-muted)', fontSize: '13px' }}>
                  Contact your administrator for account access
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ==================== REGISTER PAGE ====================
    function RegisterPage({ onRegister, onSwitchToLogin, onBack }) {
      const [formData, setFormData] = useState({
        email: '',
        password: '',
        confirmPassword: '',
        full_name: '',
        role: 'candidate',
        phone: '',
      });
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState(null);

      const handleSubmit = async (e) => {
        e.preventDefault();

        if (formData.password !== formData.confirmPassword) {
          setError('Passwords do not match');
          return;
        }

        if (formData.password.length < 6) {
          setError('Password must be at least 6 characters');
          return;
        }

        setLoading(true);
        setError(null);

        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/auth/register/`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              email: formData.email,
              password: formData.password,
              full_name: formData.full_name,
              role: formData.role,
              phone: formData.phone || null,
            }),
          });

          const data = await response.json();

          if (data.success) {
            // Auto-login after registration
            const loginResponse = await fetch(`${API_CONFIG.BASE_URL}/auth/login/`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                email: formData.email,
                password: formData.password,
              }),
            });

            const loginData = await loginResponse.json();
            if (loginData.success) {
              localStorage.setItem('token', loginData.token);
              localStorage.setItem('user', JSON.stringify(loginData.user));
              onRegister(loginData.user, loginData.token);
            }
          } else {
            setError(data.message || 'Registration failed');
          }
        } catch (err) {
          setError('Connection error. Please try again.');
        } finally {
          setLoading(false);
        }
      };

      return (
        <div style={{
          minHeight: '100vh',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          background: 'var(--bg-primary)',
          backgroundImage: 'var(--gradient-mesh)',
          padding: '20px',
        }}>
          {onBack && (
            <button
              onClick={onBack}
              style={{
                position: 'fixed',
                top: '24px',
                left: '24px',
                background: 'none',
                border: 'none',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                color: 'var(--text-secondary)',
                cursor: 'pointer',
                fontWeight: '600',
                zIndex: 10,
              }}
            >
              <span style={{ transform: 'rotate(180deg)', display: 'inline-flex' }}><Icons.ChevronRight /></span>
              Back to Home
            </button>
          )}
          <div style={{
            width: '100%',
            maxWidth: '480px',
            animation: 'fadeInUp 0.6s ease-out',
          }}>
            <div style={{ textAlign: 'center', marginBottom: '40px' }}>
              <div style={{
                width: '64px',
                height: '64px',
                borderRadius: '16px',
                background: 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                margin: '0 auto 20px',
                color: '#ffffff',
              }}>
                <Icons.Users />
              </div>
              <h1 style={{ fontSize: '32px', fontWeight: '600', marginBottom: '8px', color: 'var(--text-primary)' }}>
                Join <span style={{ color: 'var(--accent-primary)' }}>TalentFlow AI</span>
              </h1>
              <p style={{ color: 'var(--text-secondary)', fontSize: '16px' }}>
                Create your account to get started
              </p>
            </div>

            <div style={{
              ...styles.card,
              boxShadow: '0 4px 24px rgba(0, 0, 0, 0.08)',
            }}>
              <form onSubmit={handleSubmit}>
                {error && (
                  <div style={{
                    padding: '12px 16px',
                    background: 'rgba(239, 68, 68, 0.1)',
                    border: '1px solid var(--danger)',
                    borderRadius: '8px',
                    color: 'var(--danger)',
                    marginBottom: '20px',
                    fontSize: '14px',
                  }}>
                    {error}
                  </div>
                )}

                {/* Role Selection */}
                <div style={{ marginBottom: '24px' }}>
                  <label style={styles.label}>I am a...</label>
                  <div style={{ display: 'flex', gap: '12px' }}>
                    {[
                      { id: 'hr', label: 'HR Professional', icon: <Icons.Briefcase />, desc: 'Hire & manage talent' },
                      { id: 'candidate', label: 'Job Candidate', icon: <Icons.Users />, desc: 'Find opportunities' },
                    ].map((role) => (
                      <button
                        key={role.id}
                        type="button"
                        onClick={() => setFormData({ ...formData, role: role.id })}
                        style={{
                          flex: 1,
                          padding: '16px',
                          background: formData.role === role.id ? 'var(--accent-glow)' : 'var(--bg-secondary)',
                          border: `2px solid ${formData.role === role.id ? 'var(--accent-primary)' : 'var(--border-color)'}`,
                          borderRadius: '12px',
                          cursor: 'pointer',
                          textAlign: 'center',
                          transition: 'all 0.2s ease',
                        }}
                      >
                        <div style={{
                          color: formData.role === role.id ? 'var(--accent-primary)' : 'var(--text-muted)',
                          marginBottom: '8px',
                          display: 'flex',
                          justifyContent: 'center',
                        }}>
                          {role.icon}
                        </div>
                        <div style={{
                          fontWeight: '600',
                          fontSize: '14px',
                          color: formData.role === role.id ? 'var(--text-primary)' : 'var(--text-secondary)',
                          marginBottom: '4px',
                        }}>
                          {role.label}
                        </div>
                        <div style={{ fontSize: '12px', color: 'var(--text-muted)' }}>
                          {role.desc}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>

                <div style={styles.formGroup}>
                  <label style={styles.label}>Full Name</label>
                  <input
                    type="text"
                    style={styles.input}
                    placeholder="John Doe"
                    value={formData.full_name}
                    onChange={(e) => setFormData({ ...formData, full_name: e.target.value })}
                    required
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>

                <div style={styles.formGroup}>
                  <label style={styles.label}>Email Address</label>
                  <input
                    type="email"
                    style={styles.input}
                    placeholder="you@company.com"
                    value={formData.email}
                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                    required
                    onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                    onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                  />
                </div>

                {formData.role === 'candidate' && (
                  <div style={styles.formGroup}>
                    <label style={styles.label}>Phone Number (Optional)</label>
                    <input
                      type="tel"
                      style={styles.input}
                      placeholder="+1 (555) 000-0000"
                      value={formData.phone}
                      onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                      onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                      onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                    />
                  </div>
                )}

                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                  <div style={styles.formGroup}>
                    <label style={styles.label}>Password</label>
                    <input
                      type="password"
                      style={styles.input}
                      placeholder=""
                      value={formData.password}
                      onChange={(e) => setFormData({ ...formData, password: e.target.value })}
                      required
                      onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                      onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                    />
                  </div>
                  <div style={styles.formGroup}>
                    <label style={styles.label}>Confirm Password</label>
                    <input
                      type="password"
                      style={styles.input}
                      placeholder=""
                      value={formData.confirmPassword}
                      onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}
                      required
                      onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                      onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                    />
                  </div>
                </div>

                <button
                  type="submit"
                  style={{
                    ...styles.button('primary'),
                    width: '100%',
                    marginTop: '8px',
                    opacity: loading ? 0.7 : 1,
                  }}
                  disabled={loading}
                >
                  {loading ? <Spinner size={18} /> : 'Create Account'}
                </button>
              </form>

              <div style={{
                textAlign: 'center',
                marginTop: '24px',
                paddingTop: '24px',
                borderTop: '1px solid var(--border-color)',
              }}>
                <p style={{ color: 'var(--text-secondary)', fontSize: '14px' }}>
                  Already have an account?{' '}
                  <button
                    onClick={onSwitchToLogin}
                    style={{
                      background: 'none',
                      border: 'none',
                      color: 'var(--accent-primary)',
                      fontWeight: '600',
                      cursor: 'pointer',
                      fontSize: '14px',
                    }}
                  >
                    Sign in
                  </button>
                </p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ==================== CANDIDATE PAGES ====================

    // Job Listings Page (for Candidates)
    function JobListingsPage({ user }) {
      const [jobs, setJobs] = useState([]);
      const [selectedJob, setSelectedJob] = useState(null);
      const [loading, setLoading] = useState(true);
      const [applying, setApplying] = useState(false);
      const [showApplyModal, setShowApplyModal] = useState(false);
      const [resumeFile, setResumeFile] = useState(null);
      const [coverLetter, setCoverLetter] = useState('');
      const [applySuccess, setApplySuccess] = useState(false);
      const [error, setError] = useState(null);
      const [myApplications, setMyApplications] = useState([]);
      const fileInputRef = useRef(null);

      // Additional candidate fields
      const [applicantName, setApplicantName] = useState(user?.full_name || '');
      const [relevantExperience, setRelevantExperience] = useState('');
      const [overallExperience, setOverallExperience] = useState('');
      const [currentLocation, setCurrentLocation] = useState('');
      const [preferredLocation, setPreferredLocation] = useState('');
      const [currentCTC, setCurrentCTC] = useState('');
      const [expectedCTC, setExpectedCTC] = useState('');
      const [currentCompany, setCurrentCompany] = useState('');
      const [noticePeriod, setNoticePeriod] = useState('');

      useEffect(() => {
        fetchJobs();
        fetchMyApplications();
      }, []);

      const fetchJobs = async () => {
        try {
          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/?status=active`);
          const data = await response.json();
          setJobs(data.jobs || []);
        } catch (e) {
          console.error("Jobs error", e);
        } finally {
          setLoading(false);
        }
      };

      const fetchMyApplications = async () => {
        try {
          const token = localStorage.getItem('token');
          if (!token) return;
          const response = await fetch(`${API_CONFIG.BASE_URL}/job-applications/my/?token=${token}`);
          const data = await response.json();
          setMyApplications(data.applications || []);
        } catch (e) {
          console.error("My applications error", e);
        }
      };

      const hasApplied = (jobId) => {
        return myApplications.some(app => app.job_id === jobId);
      };

      const handleApply = async () => {
        if (!selectedJob) return;

        setApplying(true);
        setError(null);

        try {
          const token = localStorage.getItem('token');
          const formData = new FormData();
          formData.append('token', token);
          if (resumeFile) {
            formData.append('resume_file', resumeFile);
          }
          if (coverLetter) {
            formData.append('cover_letter', coverLetter);
          }

          // Additional candidate fields
          formData.append('applicant_name', applicantName);
          formData.append('relevant_experience', relevantExperience);
          formData.append('overall_experience', overallExperience);
          formData.append('current_location', currentLocation);
          formData.append('preferred_location', preferredLocation);
          formData.append('current_ctc', currentCTC);
          formData.append('expected_ctc', expectedCTC);
          formData.append('current_company', currentCompany);
          formData.append('notice_period', noticePeriod);

          const response = await fetch(`${API_CONFIG.BASE_URL}/jobs/${selectedJob.id}/apply/`, {
            method: 'POST',
            body: formData
          });

          const data = await response.json();

          if (!response.ok) {
            throw new Error(data.detail || 'Failed to submit application');
          }

          setApplySuccess(true);
          setShowApplyModal(false);
          setResumeFile(null);
          setCoverLetter('');
          // Reset additional fields
          setRelevantExperience('');
          setOverallExperience('');
          setCurrentLocation('');
          setPreferredLocation('');
          setCurrentCTC('');
          setExpectedCTC('');
          setCurrentCompany('');
          setNoticePeriod('');
          fetchMyApplications();
          setTimeout(() => setApplySuccess(false), 3000);
        } catch (err) {
          setError(err.message);
        } finally {
          setApplying(false);
        }
      };

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading job listings...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Job</span> Listings
            </h1>
            <p style={styles.pageSubtitle}>
              Browse available positions and apply to your dream job.
            </p>
          </div>

          {applySuccess && (
            <div style={{
              padding: '16px',
              background: 'rgba(34, 197, 94, 0.1)',
              borderRadius: '12px',
              marginBottom: '24px',
              color: 'var(--success)',
              display: 'flex',
              alignItems: 'center',
              gap: '12px',
              fontSize: '14px',
              fontWeight: '500'
            }}>
              <Icons.Check /> Your application has been submitted successfully!
            </div>
          )}

          <div style={styles.grid}>
            <div style={styles.card} className="animate-in delay-1">
              <div style={styles.cardHeader}>
                <div style={styles.cardIcon('var(--accent-primary)')}>
                  <Icons.Briefcase />
                </div>
                <div>
                  <h3 style={styles.cardTitle}>Available Jobs ({jobs.length})</h3>
                  <p style={styles.cardDescription}>Click to view details</p>
                </div>
              </div>

              {jobs.length === 0 ? (
                <div style={{ padding: '40px', textAlign: 'center', color: 'var(--text-secondary)' }}>
                  No jobs available at the moment.
                </div>
              ) : (
                jobs.map((job) => (
                  <div
                    key={job.id}
                    style={{
                      ...styles.candidateCard,
                      borderColor: selectedJob?.id === job.id ? 'var(--accent-primary)' : 'transparent',
                    }}
                    onClick={() => setSelectedJob(job)}
                  >
                    <div style={{
                      ...styles.avatar,
                      background: 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)'
                    }}>
                      <Icons.Briefcase />
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '600', marginBottom: '4px' }}>{job.title}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{job.company_name}</div>
                      <div style={{ fontSize: '12px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        {job.location && <span>{job.location}  </span>}
                        {job.experience_level}
                      </div>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      {hasApplied(job.id) ? (
                        <span style={{
                          display: 'inline-block',
                          padding: '4px 12px',
                          fontSize: '12px',
                          fontWeight: '600',
                          color: 'var(--success)',
                          background: 'rgba(34, 197, 94, 0.1)',
                          borderRadius: '20px',
                        }}>
                          Applied
                        </span>
                      ) : (
                        <span style={{
                          display: 'inline-block',
                          padding: '4px 12px',
                          fontSize: '12px',
                          fontWeight: '600',
                          color: 'var(--accent-primary)',
                          background: 'var(--accent-glow)',
                          borderRadius: '20px',
                        }}>
                          Open
                        </span>
                      )}
                      <div style={{ fontSize: '11px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        {new Date(job.created_at).toLocaleDateString()}
                      </div>
                    </div>
                  </div>
                ))
              )}
            </div>

            <div style={styles.card} className="animate-in delay-2">
              {selectedJob ? (
                <>
                  <div style={{ marginBottom: '24px' }}>
                    <h3 style={{ fontSize: '24px', fontWeight: '600', marginBottom: '8px' }}>{selectedJob.title}</h3>
                    <div style={{ color: 'var(--text-secondary)', marginBottom: '12px' }}>
                      {selectedJob.company_name}
                    </div>
                    <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
                      {selectedJob.location && (
                        <span style={styles.tag('var(--accent-primary)')}>
                          {selectedJob.location}
                        </span>
                      )}
                      {selectedJob.experience_level && (
                        <span style={styles.tag('var(--accent-blue)')}>
                          {selectedJob.experience_level}
                        </span>
                      )}
                    </div>
                  </div>

                  {/* Skills */}
                  {selectedJob.skills && (
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                        Required Skills
                      </div>
                      <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                        {selectedJob.skills.split(',').map((skill, i) => (
                          <span key={i} style={{
                            padding: '4px 10px',
                            background: 'var(--bg-tertiary)',
                            borderRadius: '6px',
                            fontSize: '12px',
                            color: 'var(--text-primary)'
                          }}>
                            {skill.trim()}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}

                  {/* Job Description */}
                  <div style={{ marginBottom: '24px' }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: 'var(--text-secondary)', marginBottom: '8px', textTransform: 'uppercase' }}>
                      Job Description
                    </div>
                    <div style={{
                      background: 'var(--bg-secondary)',
                      padding: '16px',
                      borderRadius: '8px',
                      fontSize: '14px',
                      lineHeight: '1.7',
                      whiteSpace: 'pre-wrap',
                      maxHeight: '300px',
                      overflow: 'auto'
                    }}>
                      {selectedJob.description}
                    </div>
                  </div>

                  {/* Apply Button */}
                  {hasApplied(selectedJob.id) ? (
                    <div style={{
                      padding: '16px',
                      background: 'rgba(34, 197, 94, 0.1)',
                      borderRadius: '8px',
                      color: 'var(--success)',
                      textAlign: 'center',
                      fontWeight: '500'
                    }}>
                      <Icons.Check style={{ marginRight: '8px' }} />
                      You've already applied to this position
                    </div>
                  ) : (
                    <button
                      style={{ ...styles.button('primary'), width: '100%' }}
                      onClick={() => setShowApplyModal(true)}
                    >
                      <Icons.FileText /> Apply Now
                    </button>
                  )}
                </>
              ) : (
                <div style={{ textAlign: 'center', padding: '100px 20px', color: 'var(--text-muted)' }}>
                  Select a job to view details
                </div>
              )}
            </div>
          </div>

          {/* Apply Modal */}
          {showApplyModal && selectedJob && (
            <div style={{
              position: 'fixed',
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              background: 'rgba(0,0,0,0.5)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              zIndex: 2000
            }}>
              <div style={{
                background: 'var(--bg-card)',
                borderRadius: '16px',
                padding: '32px',
                width: '100%',
                maxWidth: '650px',
                maxHeight: '90vh',
                overflow: 'auto'
              }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '24px' }}>
                  <h3 style={{ fontSize: '20px', fontWeight: '600' }}>Apply for {selectedJob.title}</h3>
                  <button
                    onClick={() => { setShowApplyModal(false); setError(null); }}
                    style={{ background: 'none', border: 'none', cursor: 'pointer', color: 'var(--text-muted)' }}
                  >
                    <Icons.X />
                  </button>
                </div>

                {error && (
                  <div style={{
                    padding: '12px',
                    background: 'rgba(239, 68, 68, 0.1)',
                    color: 'var(--danger)',
                    borderRadius: '8px',
                    marginBottom: '20px',
                    fontSize: '14px'
                  }}>
                    {error}
                  </div>
                )}

                {/* Personal Information Section */}
                <div style={{ marginBottom: '24px' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px', paddingBottom: '8px', borderBottom: '1px solid var(--border-color)' }}>
                    Personal Information
                  </div>

                  <div style={styles.formGroup}>
                    <label style={styles.label}>Full Name *</label>
                    <input
                      type="text"
                      style={styles.input}
                      placeholder="Your full name"
                      value={applicantName}
                      onChange={(e) => setApplicantName(e.target.value)}
                      required
                      onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                      onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                    />
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Current Location *</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., Mumbai, India"
                        value={currentLocation}
                        onChange={(e) => setCurrentLocation(e.target.value)}
                        required
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Preferred Location</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., Bangalore, Remote"
                        value={preferredLocation}
                        onChange={(e) => setPreferredLocation(e.target.value)}
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                  </div>
                </div>

                {/* Experience Section */}
                <div style={{ marginBottom: '24px' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px', paddingBottom: '8px', borderBottom: '1px solid var(--border-color)' }}>
                    Experience Details
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Relevant Experience (Years) *</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., 3"
                        value={relevantExperience}
                        onChange={(e) => setRelevantExperience(e.target.value)}
                        required
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Overall Experience (Years) *</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., 5"
                        value={overallExperience}
                        onChange={(e) => setOverallExperience(e.target.value)}
                        required
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Current Company</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="Your current employer"
                        value={currentCompany}
                        onChange={(e) => setCurrentCompany(e.target.value)}
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Notice Period *</label>
                      <select
                        style={styles.select}
                        value={noticePeriod}
                        onChange={(e) => setNoticePeriod(e.target.value)}
                        required
                      >
                        <option value="">Select notice period</option>
                        <option value="Immediate">Immediate</option>
                        <option value="15 Days">15 Days</option>
                        <option value="30 Days">30 Days</option>
                        <option value="45 Days">45 Days</option>
                        <option value="60 Days">60 Days</option>
                        <option value="90 Days">90 Days</option>
                        <option value="More than 90 Days">More than 90 Days</option>
                      </select>
                    </div>
                  </div>
                </div>

                {/* Compensation Section */}
                <div style={{ marginBottom: '24px' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px', paddingBottom: '8px', borderBottom: '1px solid var(--border-color)' }}>
                    Compensation
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Current CTC (LPA) *</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., 12"
                        value={currentCTC}
                        onChange={(e) => setCurrentCTC(e.target.value)}
                        required
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                    <div style={styles.formGroup}>
                      <label style={styles.label}>Expected CTC (LPA) *</label>
                      <input
                        type="text"
                        style={styles.input}
                        placeholder="e.g., 15"
                        value={expectedCTC}
                        onChange={(e) => setExpectedCTC(e.target.value)}
                        required
                        onFocus={(e) => e.target.style.borderColor = 'var(--accent-primary)'}
                        onBlur={(e) => e.target.style.borderColor = 'var(--border-color)'}
                      />
                    </div>
                  </div>
                </div>

                {/* Resume Upload Section */}
                <div style={{ marginBottom: '24px' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px', paddingBottom: '8px', borderBottom: '1px solid var(--border-color)' }}>
                    Documents
                  </div>

                  <div style={styles.formGroup}>
                    <label style={styles.label}>Resume (PDF or DOCX) *</label>
                    <div
                      style={{
                        ...styles.dropzone(false),
                        padding: '20px'
                      }}
                      onClick={() => fileInputRef.current?.click()}
                    >
                      <input
                        type="file"
                        ref={fileInputRef}
                        style={{ display: 'none' }}
                        onChange={(e) => setResumeFile(e.target.files[0])}
                        accept=".pdf,.docx,.doc"
                      />
                      <div style={{ color: 'var(--accent-primary)', marginBottom: '8px' }}>
                        <Icons.Upload />
                      </div>
                      <div style={{ fontSize: '14px' }}>
                        {resumeFile ? resumeFile.name : 'Click to upload your resume'}
                      </div>
                    </div>
                  </div>

                  <div style={styles.formGroup}>
                    <label style={styles.label}>Cover Letter (Optional)</label>
                    <textarea
                      style={{ ...styles.textarea, minHeight: '100px' }}
                      placeholder="Tell us why you're interested in this position..."
                      value={coverLetter}
                      onChange={(e) => setCoverLetter(e.target.value)}
                    />
                  </div>
                </div>

                <div style={{ display: 'flex', gap: '12px' }}>
                  <button
                    style={{ ...styles.button('secondary'), flex: 1 }}
                    onClick={() => { setShowApplyModal(false); setError(null); }}
                  >
                    Cancel
                  </button>
                  <button
                    style={{ ...styles.button('primary'), flex: 1, opacity: applying ? 0.7 : 1 }}
                    onClick={handleApply}
                    disabled={applying}
                  >
                    {applying ? <Spinner size={16} /> : <Icons.Check />}
                    {applying ? 'Submitting...' : 'Submit Application'}
                  </button>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    // My Applications Page (for Candidates)
    function MyApplicationsPage({ user }) {
      const [applications, setApplications] = useState([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetchApplications();
      }, []);

      const fetchApplications = async () => {
        try {
          const token = localStorage.getItem('token');
          if (!token) return;
          const response = await fetch(`${API_CONFIG.BASE_URL}/job-applications/my/?token=${token}`);
          const data = await response.json();
          setApplications(data.applications || []);
        } catch (e) {
          console.error("Applications error", e);
        } finally {
          setLoading(false);
        }
      };

      const statusColors = {
        pending: 'var(--warning)',
        reviewed: 'var(--accent-blue)',
        shortlisted: 'var(--success)',
        rejected: 'var(--danger)',
        hired: 'var(--accent-purple)'
      };

      const statusLabels = {
        pending: 'Under Review',
        reviewed: 'Reviewed',
        shortlisted: 'Shortlisted',
        rejected: 'Not Selected',
        hired: 'Hired!'
      };

      if (loading) return <div style={{ padding: '40px', textAlign: 'center' }}>Loading applications...</div>;

      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-blue)' }}>My</span> Applications
            </h1>
            <p style={styles.pageSubtitle}>
              Track the status of your job applications.
            </p>
          </div>

          <div style={{ ...styles.card, maxWidth: '800px' }} className="animate-in delay-1">
            {applications.length === 0 ? (
              <div style={{ padding: '60px 20px', textAlign: 'center', color: 'var(--text-muted)' }}>
                <div style={{ marginBottom: '16px' }}>
                  <Icons.FileText />
                </div>
                <p>You haven't applied to any jobs yet.</p>
                <p style={{ fontSize: '14px', marginTop: '8px' }}>Browse available positions in Job Listings.</p>
              </div>
            ) : (
              <div>
                <div style={{ marginBottom: '20px', color: 'var(--text-secondary)', fontSize: '14px' }}>
                  {applications.length} application(s)
                </div>
                {applications.map((app) => (
                  <div
                    key={app.id}
                    style={{
                      display: 'flex',
                      alignItems: 'center',
                      gap: '16px',
                      padding: '20px',
                      background: 'var(--bg-secondary)',
                      borderRadius: '12px',
                      marginBottom: '12px',
                    }}
                  >
                    <div style={{
                      ...styles.avatar,
                      background: 'linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-purple) 100%)'
                    }}>
                      <Icons.Briefcase />
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontWeight: '600', marginBottom: '4px' }}>{app.job_title || 'Unknown Position'}</div>
                      <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{app.company_name}</div>
                      <div style={{ fontSize: '12px', color: 'var(--text-muted)', marginTop: '4px' }}>
                        Applied on {new Date(app.created_at).toLocaleDateString()}
                      </div>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <span style={{
                        display: 'inline-block',
                        padding: '6px 14px',
                        fontSize: '12px',
                        fontWeight: '600',
                        color: statusColors[app.status],
                        background: `${statusColors[app.status]}15`,
                        borderRadius: '20px',
                      }}>
                        {statusLabels[app.status] || app.status}
                      </span>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      );
    }

    // ==================== CANDIDATE DASHBOARD ====================
    function CandidateDashboard({ user }) {
      return (
        <div>
          <div style={styles.pageHeader} className="animate-in">
            <h1 style={styles.pageTitle}>
              <span className="serif" style={{ fontStyle: 'italic', color: 'var(--accent-primary)' }}>Welcome, {user.full_name}</span>
            </h1>
            <p style={styles.pageSubtitle}>
              Complete your AI-powered interview to move forward in the hiring process.
            </p>
          </div>

          <div style={{ ...styles.card, maxWidth: '600px', margin: '0 auto', textAlign: 'center' }} className="animate-in delay-1">
            <div style={{
              width: '80px',
              height: '80px',
              borderRadius: '20px',
              background: 'linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              margin: '0 auto 24px',
              color: '#ffffff',
            }}>
              <Icons.Mic />
            </div>
            <h2 style={{ fontSize: '24px', fontWeight: '600', marginBottom: '12px' }}>
              AI Voice Interview
            </h2>
            <p style={{ color: 'var(--text-secondary)', marginBottom: '32px', lineHeight: '1.6' }}>
              Our AI interviewer will ask you a series of questions about your experience,
              skills, and career goals. The interview typically takes 10-15 minutes.
            </p>

            <div style={{
              background: 'var(--bg-secondary)',
              borderRadius: '12px',
              padding: '20px',
              marginBottom: '24px',
              textAlign: 'left',
            }}>
              <h3 style={{ fontSize: '14px', fontWeight: '600', marginBottom: '16px', color: 'var(--text-primary)' }}>
                Tips for a great interview:
              </h3>
              <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>
                {[
                  'Find a quiet place with minimal background noise',
                  'Speak clearly and at a natural pace',
                  'Be specific with examples from your experience',
                  'Take your time to think before answering',
                ].map((tip, i) => (
                  <li key={i} style={{
                    display: 'flex',
                    alignItems: 'flex-start',
                    gap: '12px',
                    marginBottom: '12px',
                    fontSize: '14px',
                    color: 'var(--text-secondary)',
                  }}>
                    <span style={{ color: 'var(--success)' }}><Icons.Check /></span>
                    {tip}
                  </li>
                ))}
              </ul>
            </div>

            <button style={styles.button('primary')}>
              <Icons.Mic /> Start Interview
            </button>
          </div>
        </div>
      );
    }

    // ==================== MAIN APP ====================
    function App() {
      const [currentPage, setCurrentPage] = useState('dashboard');
      const [user, setUser] = useState(null);
      const [token, setToken] = useState(null);
      const [authPage, setAuthPage] = useState('landing');

      // Check for existing session on mount
      useEffect(() => {
        const savedToken = localStorage.getItem('token');
        const savedUser = localStorage.getItem('user');

        if (savedToken && savedUser) {
          setToken(savedToken);
          setUser(JSON.parse(savedUser));
        }
      }, []);

      const handleLogin = (userData, authToken) => {
        setUser(userData);
        setToken(authToken);
        setCurrentPage('dashboard');
      };

      const handleLogout = () => {
        localStorage.removeItem('token');
        localStorage.removeItem('user');
        setUser(null);
        setToken(null);
        setAuthPage('login');
      };

      // If not logged in, show login pages
      if (!user) {
        if (authPage === 'landing') {
          return (
            <LandingPage
              onLogin={() => setAuthPage('login')}
            />
          );
        }
        // Only login page now - no more registration
        return (
          <LoginPage
            onLogin={handleLogin}
            onBack={() => setAuthPage('landing')}
          />
        );
      }

      // Role-based page access
      const isHR = user.role === 'hr';

      const hrPages = {
        dashboard: DashboardPage,
        resume: ResumeScorePage,
        jd: JDGeneratorPage,
        voice: VoiceAgentPage,
        candidates: CandidatesPage,
        jobs: JobPostingsManagementPage,
        applications: JobApplicationsPage,
        email: BulkEmailPage,
        settings: SettingsPage,
      };

      const candidatePages = {
        dashboard: () => <CandidateDashboard user={user} />,
        jobs: () => <JobListingsPage user={user} />,
        myapplications: () => <MyApplicationsPage user={user} />,
        voice: VoiceAgentPage,
        settings: SettingsPage,
      };

      const pages = isHR ? hrPages : candidatePages;
      const PageComponent = pages[currentPage] || pages.dashboard;

      // Navigation items based on role
      const hrNavItems = [
        { id: 'dashboard', label: 'Dashboard' },
        { id: 'resume', label: 'Resume Scoring' },
        { id: 'jd', label: 'JD Generator' },
        { id: 'candidates', label: 'Candidates' },
        { id: 'jobs', label: 'Job Postings' },
        { id: 'applications', label: 'Applications' },
        { id: 'email', label: 'Email Candidates' },
      ];

      const candidateNavItems = [
        { id: 'dashboard', label: 'Dashboard' },
        { id: 'jobs', label: 'Job Listings' },
        { id: 'myapplications', label: 'My Applications' },
        { id: 'voice', label: 'Interview' },
      ];

      const navItems = isHR ? hrNavItems : candidateNavItems;

      return (
        <div style={styles.container}>
          <header style={styles.header}>
            <div style={styles.logo}>
              <div style={styles.logoIcon}>
                <Icons.Zap />
              </div>
              <span>TalentFlow<span style={{ color: 'var(--accent-primary)' }}>AI</span></span>
            </div>

            <nav style={styles.nav}>
              {navItems.map((item) => (
                <button
                  key={item.id}
                  style={styles.navButton(currentPage === item.id)}
                  onClick={() => setCurrentPage(item.id)}
                  onMouseEnter={(e) => {
                    if (currentPage !== item.id) {
                      e.target.style.color = 'var(--text-primary)';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentPage !== item.id) {
                      e.target.style.color = 'var(--text-secondary)';
                    }
                  }}
                >
                  {item.label}
                </button>
              ))}
            </nav>

            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              {/* User info */}
              <div style={{
                display: 'flex',
                alignItems: 'center',
                gap: '10px',
                padding: '6px 12px',
                background: 'var(--bg-tertiary)',
                borderRadius: '8px',
              }}>
                <div style={{
                  width: '32px',
                  height: '32px',
                  borderRadius: '8px',
                  background: isHR
                    ? 'linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-blue) 100%)'
                    : 'linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-orange) 100%)',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  color: '#fff',
                  fontSize: '14px',
                  fontWeight: '600',
                }}>
                  {user.full_name.charAt(0).toUpperCase()}
                </div>
                <div>
                  <div style={{ fontSize: '13px', fontWeight: '500', color: 'var(--text-primary)' }}>
                    {user.full_name}
                  </div>
                  <div style={{ fontSize: '11px', color: 'var(--text-muted)', textTransform: 'uppercase' }}>
                    {user.role}
                  </div>
                </div>
              </div>

              <button
                style={{ ...styles.navButton(currentPage === 'settings'), padding: '10px' }}
                onClick={() => setCurrentPage('settings')}
              >
                <Icons.Settings />
              </button>

              <button
                onClick={handleLogout}
                style={{
                  ...styles.navButton(false),
                  padding: '10px',
                  color: 'var(--danger)',
                }}
                title="Logout"
              >
                <Icons.X />
              </button>
            </div>
          </header>

          <main style={styles.main}>
            <PageComponent onNavigate={setCurrentPage} />
          </main>

          <footer style={{
            padding: '24px 32px',
            textAlign: 'center',
            color: 'var(--text-muted)',
            fontSize: '13px',
            borderTop: '1px solid var(--border-color)',
          }}>
            <p>TalentFlow AI  Intelligent Recruitment Platform</p>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>

</html>